(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    165789,       3965]
NotebookOptionsPosition[    158627,       3727]
NotebookOutlinePosition[    159016,       3743]
CellTagsIndexPosition[    158973,       3740]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Equal Proportions", "Title",
 CellChangeTimes->{{3.5610531328341208`*^9, 3.561053155719361*^9}, {
  3.5622597851110063`*^9, 3.5622597877786107`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[Cell[TextData[{
  "This ",
  StyleBox["Mathematica",
   FontSlant->"Italic"],
  " notebook is licensed under a ",
  Cell[BoxData[
   RowBox[{
    TagBox[
     ButtonBox[
      PaneSelectorBox[{
       False->"\<\"Creative Commons Attribution - ShareAlike 3.0 License\"\>",
        True->
       StyleBox["\<\"Creative Commons Attribution - ShareAlike 3.0 \
License\"\>", "HyperlinkActive"]}, Dynamic[
        CurrentValue["MouseOver"]],
       BaseStyle->{"Hyperlink"},
       BaselinePosition->Baseline,
       FrameMargins->0,
       ImageSize->Automatic],
      BaseStyle->"Hyperlink",
      ButtonData->{
        URL["http://creativecommons.org/licenses/by-sa/3.0/"], None},
      ButtonNote->"http://creativecommons.org/licenses/by-sa/3.0/"],
     Annotation[#, "http://creativecommons.org/licenses/by-sa/3.0/", 
      "Hyperlink"]& ], " ", "."}]],
   CellChangeTimes->{{3.516312542019249*^9, 3.5163126250020304`*^9}}],
  " It is discussed in the post ",
  ButtonBox["Apportionment I",
   BaseStyle->"Hyperlink",
   ButtonData->{
     URL["http://www.abstractmath.org/Word%20Press/?p=6279"], None},
   ButtonNote->"http://www.abstractmath.org/Word%20Press/?p=6279"],
  ". I hope anyone interested will feel free to improve this work and to use \
it in their own publications and coursework. --",
  ButtonBox["Charles Wells",
   BaseStyle->"Hyperlink",
   ButtonData->{
     URL["http://www.cwru.edu/artsci/math/wells/home.html"], None},
   ButtonNote->"http://www.cwru.edu/artsci/math/wells/home.html"],
  " \n\n "
 }], "Text",
  Evaluatable->False,
  CellChangeTimes->{{3.51611951760275*^9, 3.516119657634*^9}, 
    3.516120664774625*^9, {3.516120746837125*^9, 3.51612074916525*^9}, 
    3.516120830243375*^9, 3.51612090022775*^9, 3.516120944055875*^9, {
    3.516121051618375*^9, 3.5161211093215*^9}, {3.516121230337125*^9, 
    3.51612123135275*^9}, {3.516121283305875*^9, 3.516121332009*^9}, {
    3.516121381024625*^9, 3.516121383962125*^9}, {3.516121434337125*^9, 
    3.5161214348215*^9}, {3.516121468274625*^9, 3.516121501743375*^9}, {
    3.516121535462125*^9, 3.516121541274625*^9}, {3.5161279704465*^9, 
    3.516128130055875*^9}, {3.5163122776337*^9, 3.516312416834152*^9}, {
    3.5163126056274023`*^9, 3.516312632939378*^9}, {3.516312928761823*^9, 
    3.5163130078071804`*^9}, {3.5163130407127986`*^9, 
    3.5163131184300566`*^9}, {3.5164812129469624`*^9, 3.516481214321944*^9}, {
    3.516555426265625*^9, 3.516555493953125*^9}, {3.516621627109375*^9, 
    3.516621681125*^9}, {3.516621758984375*^9, 3.516621759328125*^9}, {
    3.5175085827356*^9, 3.5175088086236*^9}, {3.5175088567827997`*^9, 
    3.5175088855024*^9}, {3.5175089295256*^9, 3.5175090540136003`*^9}, {
    3.5175091693932*^9, 3.517509206802*^9}, {3.5175991947522*^9, 
    3.5175991966554003`*^9}, {3.5176120262064*^9, 3.5176120605888*^9}, {
    3.5177600004638*^9, 3.5177600149094*^9}, {3.5177619153627996`*^9, 
    3.5177619161584*^9}, {3.5177619594952*^9, 3.5177620453732*^9}, {
    3.5177621152924*^9, 3.5177621280376*^9}}]], "Input",
 CellChangeTimes->{{3.5637489400583787`*^9, 3.5637489709953117`*^9}, {
  3.563749006181679*^9, 3.563749067621193*^9}, {3.563749184979905*^9, 
  3.5637491849849052`*^9}}],

Cell[BoxData[
 InterpretationBox[Cell[TextData[{
   "This ",
   StyleBox["Mathematica",
    StripOnInput->False,
    FontSlant->"Italic"],
   " notebook is licensed under a ",
   Cell[BoxData[
    RowBox[{"ErrorBox", "[", 
     RowBox[{"ErrorBox", "[", 
      RowBox[{"RowBox", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"TagBox", "[", 
          RowBox[{
           RowBox[{"ButtonBox", "[", 
            RowBox[{
             RowBox[{"PaneSelectorBox", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "False", 
                  "\[Rule]", "\<\"\\\"Creative Commons Attribution - \
ShareAlike 3.0 License\\\"\"\>"}], ",", 
                 RowBox[{"True", "\[Rule]", 
                  RowBox[{"StyleBox", "[", 
                   
                   RowBox[{"\<\"\\\"Creative Commons Attribution - ShareAlike \
3.0 License\\\"\"\>", ",", "\<\"HyperlinkActive\"\>"}], "]"}]}]}], "}"}], ",", 
               DynamicBox[ToBoxes[
                 CurrentValue["MouseOver"], StandardForm],
                ImageSizeCache->{40., {0., 9.}}], ",", 
               RowBox[{"BaseStyle", "\[Rule]", 
                RowBox[{"{", "\<\"Hyperlink\"\>", "}"}]}], ",", 
               RowBox[{"BaselinePosition", "\[Rule]", "Baseline"}], ",", 
               RowBox[{"FrameMargins", "\[Rule]", "0"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "Automatic"}]}], "]"}], ",", 
             RowBox[{"BaseStyle", "\[Rule]", "\<\"Hyperlink\"\>"}], ",", 
             RowBox[{"ButtonData", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                "URL", "[", \
"\<\"http://creativecommons.org/licenses/by-sa/3.0/\"\>", "]"}], ",", 
                "None"}], "}"}]}], ",", 
             RowBox[{
             "ButtonNote", 
              "\[Rule]", \
"\<\"http://creativecommons.org/licenses/by-sa/3.0/\"\>"}]}], "]"}], ",", 
           RowBox[{
            TagBox["#1",
             
             Annotation[#, "http://creativecommons.org/licenses/by-sa/3.0/", 
              "Hyperlink"]& ], "&"}]}], "]"}], ",", "\<\" \"\>", 
         ",", "\<\".\"\>"}], "}"}], "]"}], "]"}], "]"}]],
    CellChangeTimes->{{3.516312542019249*^9, 3.5163126250020304`*^9}}],
   " It is discussed in the post ",
   Cell[BoxData[
    ButtonBox[
     RowBox[{"Apportionment", " ", "I"}],
     BaseStyle->"Hyperlink",
     ButtonData->{
       URL["http://www.abstractmath.org/Word%20Press/?p=6279"], None},
     ButtonNote->"http://www.abstractmath.org/Word%20Press/?p=6279"]]],
   ". I hope anyone interested will feel free to improve this work and to use \
it in their own publications and coursework. --",
   Cell[BoxData[
    ButtonBox[
     RowBox[{"Charles", " ", "Wells"}],
     BaseStyle->"Hyperlink",
     ButtonData->{
       URL["http://www.cwru.edu/artsci/math/wells/home.html"], None},
     ButtonNote->"http://www.cwru.edu/artsci/math/wells/home.html"]]],
   " \n\n "
  }], "Text",
   Evaluatable->False,
   CellChangeTimes->{{3.51611951760275*^9, 3.516119657634*^9}, 
     3.516120664774625*^9, {3.516120746837125*^9, 3.51612074916525*^9}, 
     3.516120830243375*^9, 3.51612090022775*^9, 3.516120944055875*^9, {
     3.516121051618375*^9, 3.5161211093215*^9}, {3.516121230337125*^9, 
     3.51612123135275*^9}, {3.516121283305875*^9, 3.516121332009*^9}, {
     3.516121381024625*^9, 3.516121383962125*^9}, {3.516121434337125*^9, 
     3.5161214348215*^9}, {3.516121468274625*^9, 3.516121501743375*^9}, {
     3.516121535462125*^9, 3.516121541274625*^9}, {3.5161279704465*^9, 
     3.516128130055875*^9}, {3.5163122776337*^9, 3.516312416834152*^9}, {
     3.5163126056274023`*^9, 3.516312632939378*^9}, {3.516312928761823*^9, 
     3.5163130078071804`*^9}, {3.5163130407127986`*^9, 
     3.5163131184300566`*^9}, {3.5164812129469624`*^9, 
     3.516481214321944*^9}, {3.516555426265625*^9, 3.516555493953125*^9}, {
     3.516621627109375*^9, 3.516621681125*^9}, {3.516621758984375*^9, 
     3.516621759328125*^9}, {3.5175085827356*^9, 3.5175088086236*^9}, {
     3.5175088567827997`*^9, 3.5175088855024*^9}, {3.5175089295256*^9, 
     3.5175090540136003`*^9}, {3.5175091693932*^9, 3.517509206802*^9}, {
     3.5175991947522*^9, 3.5175991966554003`*^9}, {3.5176120262064*^9, 
     3.5176120605888*^9}, {3.5177600004638*^9, 3.5177600149094*^9}, {
     3.5177619153627996`*^9, 3.5177619161584*^9}, {3.5177619594952*^9, 
     3.5177620453732*^9}, {3.5177621152924*^9, 3.5177621280376*^9}}],
  TextCell[
   Row[{"This ", 
     Style["Mathematica", FontSlant -> "Italic"], 
     " notebook is licensed under a ", 
     ExpressionCell[
      ErrorBox[
       ErrorBox[
        RowBox[{
          TagBox[
           ButtonBox[
            
            PaneSelectorBox[{
             False -> 
              "\"Creative Commons Attribution - ShareAlike 3.0 License\"", 
              True -> StyleBox[
               "\"Creative Commons Attribution - ShareAlike 3.0 License\"", 
                "HyperlinkActive"]}, 
             Dynamic[
              CurrentValue["MouseOver"]], BaseStyle -> {"Hyperlink"}, 
             BaselinePosition -> Baseline, FrameMargins -> 0, ImageSize -> 
             Automatic], BaseStyle -> "Hyperlink", ButtonData -> {
              URL["http://creativecommons.org/licenses/by-sa/3.0/"], None}, 
            ButtonNote -> "http://creativecommons.org/licenses/by-sa/3.0/"], 
           Annotation[#, "http://creativecommons.org/licenses/by-sa/3.0/", 
            "Hyperlink"]& ], " ", "."}]]], 
      CellChangeTimes -> {{3.516312542019249*^9, 3.5163126250020304`*^9}}], 
     " It is discussed in the post ", 
     RawBoxes[
      ButtonBox["Apportionment I", BaseStyle -> "Hyperlink", ButtonData -> {
         URL["http://www.abstractmath.org/Word%20Press/?p=6279"], None}, 
       ButtonNote -> "http://www.abstractmath.org/Word%20Press/?p=6279"]], 
     ". I hope anyone interested will feel free to improve this work and to \
use it in their own publications and coursework. --", 
     RawBoxes[
      ButtonBox["Charles Wells", BaseStyle -> "Hyperlink", ButtonData -> {
         URL["http://www.cwru.edu/artsci/math/wells/home.html"], None}, 
       ButtonNote -> "http://www.cwru.edu/artsci/math/wells/home.html"]], 
     " \n\n "}], "Text", Evaluatable -> False, 
   CellChangeTimes -> {{3.51611951760275*^9, 3.516119657634*^9}, 
     3.516120664774625*^9, {3.516120746837125*^9, 3.51612074916525*^9}, 
     3.516120830243375*^9, 3.51612090022775*^9, 3.516120944055875*^9, {
     3.516121051618375*^9, 3.5161211093215*^9}, {3.516121230337125*^9, 
     3.51612123135275*^9}, {3.516121283305875*^9, 3.516121332009*^9}, {
     3.516121381024625*^9, 3.516121383962125*^9}, {3.516121434337125*^9, 
     3.5161214348215*^9}, {3.516121468274625*^9, 3.516121501743375*^9}, {
     3.516121535462125*^9, 3.516121541274625*^9}, {3.5161279704465*^9, 
     3.516128130055875*^9}, {3.5163122776337*^9, 3.516312416834152*^9}, {
     3.5163126056274023`*^9, 3.516312632939378*^9}, {3.516312928761823*^9, 
     3.5163130078071804`*^9}, {3.5163130407127986`*^9, 
     3.5163131184300566`*^9}, {3.5164812129469624`*^9, 
     3.516481214321944*^9}, {3.516555426265625*^9, 3.516555493953125*^9}, {
     3.516621627109375*^9, 3.516621681125*^9}, {3.516621758984375*^9, 
     3.516621759328125*^9}, {3.5175085827356*^9, 3.5175088086236*^9}, {
     3.5175088567827997`*^9, 3.5175088855024*^9}, {3.5175089295256*^9, 
     3.5175090540136003`*^9}, {3.5175091693932*^9, 3.517509206802*^9}, {
     3.5175991947522*^9, 3.5175991966554003`*^9}, {3.5176120262064*^9, 
     3.5176120605888*^9}, {3.5177600004638*^9, 3.5177600149094*^9}, {
     3.5177619153627996`*^9, 3.5177619161584*^9}, {3.5177619594952*^9, 
     3.5177620453732*^9}, {3.5177621152924*^9, 
     3.5177621280376*^9}}]]], "Output",
 CellChangeTimes->{3.563749226918304*^9, 3.5755783498454714`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Data", "Subsection",
 CellChangeTimes->{{3.5612252090508966`*^9, 3.5612252131069036`*^9}, 
   3.5622600962691526`*^9, 3.5622601974665303`*^9}],

Cell[BoxData[
 RowBox[{"zlist", ":=", 
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.5611250303846045`*^9, 3.5611250366719646`*^9}, 
   3.5612449537129154`*^9, {3.562260009891801*^9, 3.5622600183470163`*^9}, 
   3.5622601974665303`*^9}],

Cell[BoxData[
 RowBox[{"onelist", ":=", 
  RowBox[{"{", 
   RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.562260023432625*^9, 3.562260030624237*^9}, 
   3.5622601974665303`*^9}],

Cell[BoxData[
 RowBox[{"example1prelist", ":=", 
  RowBox[{"{", 
   RowBox[{"5567", ",", "7775", ",", "4435", ",", "7800", ",", "3000"}], 
   "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"example2prelist", ":=", 
  RowBox[{"{", 
   RowBox[{"9567", ",", "7633", ",", "6112", ",", "2003", ",", "1598"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.5630344575317135`*^9, 3.563034493583377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"epsetup", "[", "l_", "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Range", "[", "5", "]"}], ",", "l", ",", "zlist", ",", "l"}], 
    "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.562265750420293*^9, 3.562265808343195*^9}, {
  3.56226586238169*^9, 3.5622658667964973`*^9}, {3.5622659488838415`*^9, 
  3.5622659512862463`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"#", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], "//", "N"}], ")"}], "&"}], "/@", 
  "example1prelist"}]], "Input",
 CellChangeTimes->{{3.562363250576686*^9, 3.562363314942398*^9}, 
   3.563034408642027*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3936.46345086551`", ",", "5497.755223725407`", ",", "3136.018574562338`", 
   ",", "5515.432893255071`", ",", "2121.320343559643`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5623632541490917`*^9, {3.5623632912615566`*^9, 3.5623633180624037`*^9}, 
   3.5623639641843386`*^9, 3.5623640162260303`*^9, 3.562364114553003*^9, 
   3.5623642077787666`*^9, 3.5623642551560497`*^9, 3.5623647027708354`*^9, 
   3.5624170531649075`*^9, 3.562418586461089*^9, 3.562419408862934*^9, 
   3.562419889109778*^9, 3.5624199794339366`*^9, 3.562420452405074*^9, 
   3.562420578843296*^9, 3.562420687934288*^9, 3.5624207713476343`*^9, 
   3.562433341482005*^9, 3.5624335091511*^9, 3.5624347104132123`*^9, 
   3.5624349361716347`*^9, 3.562435345407153*^9, 3.562455360567647*^9, 
   3.5624569019719543`*^9, 3.5624574763196173`*^9, 3.5624577892589693`*^9, 
   3.5624578765723224`*^9, 3.562458018548172*^9, 3.5626169882262783`*^9, 
   3.5626172240986924`*^9, 3.56261725703035*^9, 3.5626174445790796`*^9, 
   3.562883389447421*^9, 3.562974071615609*^9, 3.5629750605013466`*^9, 
   3.562975383811914*^9, 3.562975587314272*^9, 3.5629756526783867`*^9, 
   3.5630191949143276`*^9, 3.563019225677582*^9, 3.5630193627958317`*^9, 
   3.5630197221268625`*^9, 3.5630331291553063`*^9, 3.563034174875616*^9, 
   3.5630343236998777`*^9, 3.563034438109679*^9, 3.5630345753743205`*^9, 
   3.5631069534980583`*^9, 3.5631072250633354`*^9, 3.56310781123777*^9, 
   3.563107988719282*^9, 3.563108061836611*^9, 3.563108325071473*^9, 
   3.563108483650532*^9, 3.5631090115230584`*^9, 3.563109254665086*^9, 
   3.563110491357258*^9, 3.5631106735343776`*^9, 3.563110983491322*^9, 
   3.5631115352330914`*^9, 3.563111685523755*^9, 3.5631119176521626`*^9, 
   3.563197668036113*^9, 3.5632301942380643`*^9, 3.563230421686865*^9, 
   3.5633193894770007`*^9, 3.5633210617344513`*^9, 3.5633211530414114`*^9, 
   3.563321277794831*^9, 3.5633214596599503`*^9, 3.5633216297470493`*^9, 
   3.5633216662043133`*^9, {3.5633217400392427`*^9, 3.563321768821293*^9}, 
   3.5633218070725603`*^9, 3.563322719880186*^9, 3.563402461222478*^9, 
   3.575578350032672*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"sepsetup", "[", "l_", "]"}], ":=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Range", "[", "5", "]"}], ",", "l", ",", "onelist", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"#", "/", 
          RowBox[{"Sqrt", "[", "2", "]"}]}], "//", "N"}], ")"}], "&"}], "/@", 
      "l"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.562349906017932*^9, 3.5623499921612835`*^9}, {
  3.562363325940418*^9, 3.562363344878851*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.561681831363579*^9, 3.5616818471196065`*^9}, 
   3.5616819604694057`*^9, 3.5622601974665303`*^9, 3.5630343744935675`*^9, 
   3.563034416332841*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"#", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}], "//", "N"}], ")"}], "&"}], "/@", 
  "example1prelist"}]], "Input",
 CellChangeTimes->{{3.562363250576686*^9, 3.562363314942398*^9}, 
   3.5630343779567733`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3936.46345086551`", ",", "5497.755223725407`", ",", "3136.018574562338`", 
   ",", "5515.432893255071`", ",", "2121.320343559643`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.562456766282916*^9, 3.5624569020811543`*^9, 3.562457476475618*^9, 
   3.5624577893681693`*^9, 3.562457876681523*^9, 3.5624580186417723`*^9, 
   3.5626169883510785`*^9, 3.5626172242078924`*^9, 3.56261725713955*^9, 
   3.5626174447038803`*^9, 3.5628833895878215`*^9, 3.5629740717560096`*^9, 
   3.562975060610546*^9, 3.5629753839211144`*^9, 3.5629755874390717`*^9, 
   3.5629756527875867`*^9, 3.5630191950703278`*^9, 3.5630192258023815`*^9, 
   3.5630193629206314`*^9, 3.563019722236063*^9, 3.5630331292957067`*^9, 
   3.563034175016017*^9, 3.563034323809078*^9, 3.5630344382188797`*^9, 
   3.563034575530321*^9, 3.5631069537164583`*^9, 3.5631072252037354`*^9, 
   3.5631078113937707`*^9, 3.5631079888284826`*^9, 3.563108061945811*^9, 
   3.563108325180673*^9, 3.563108483775332*^9, 3.5631090117258587`*^9, 
   3.5631092548054857`*^9, 3.5631104914664583`*^9, 3.563110673659178*^9, 
   3.5631109836161222`*^9, 3.5631115353734913`*^9, 3.5631116856173553`*^9, 
   3.563111917776963*^9, 3.563197668176513*^9, 3.5632301943784647`*^9, 
   3.563230421780465*^9, 3.563319389586201*^9, 3.5633210618748517`*^9, 
   3.5633211531350117`*^9, 3.563321277919631*^9, 3.5633214597691507`*^9, 
   3.563321629856249*^9, 3.563321666329113*^9, {3.5633217401484427`*^9, 
   3.5633217689304934`*^9}, 3.563321807181761*^9, 3.563322719989386*^9, 
   3.5634024613164825`*^9, 3.575578350095072*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"lst1", ":=", 
  RowBox[{"epsetup", "[", "example1prelist", "]"}]}]], "Input",
 CellChangeTimes->{{3.561245100643319*^9, 3.5612451011573486`*^9}, 
   3.5612451885863495`*^9, 3.561680764830906*^9, {3.561681856495223*^9, 
   3.5616818603952303`*^9}, 3.5616819604850054`*^9, 3.561925712370736*^9, {
   3.5622599930437717`*^9, 3.5622600003757844`*^9}, {3.5622601116195793`*^9, 
   3.562260121322797*^9}, 3.56226019748213*^9, {3.562265819575215*^9, 
   3.562265821993219*^9}, 3.563034383572783*^9}],

Cell[CellGroupData[{

Cell[BoxData["lst1"], "Input",
 CellChangeTimes->{{3.561245227740589*^9, 3.5612452286036386`*^9}, 
   3.561680764862106*^9, 3.5619257123863363`*^9, 3.56226019748213*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "5567", ",", "0", ",", "5567"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7775", ",", "0", ",", "7775"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4435", ",", "0", ",", "4435"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "7800", ",", "0", ",", "7800"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3000", ",", "0", ",", "3000"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.562262009307313*^9, 3.562262983404224*^9, 3.5622656576157303`*^9, 
   3.562265826564027*^9, 3.562265984857505*^9, 3.5622660876304855`*^9, 
   3.5622661694838295`*^9, 3.56226630089846*^9, 3.562266637897052*^9, 
   3.5622670468673706`*^9, 3.5622794375364456`*^9, 3.56228018042535*^9, 
   3.5622802273034325`*^9, 3.5623240055102654`*^9, 3.5623250422464857`*^9, 
   3.562325111073807*^9, 3.5623253385690064`*^9, 3.5623256205691023`*^9, 
   3.562326085917919*^9, 3.5623264330029287`*^9, 3.5623272754648085`*^9, 
   3.5623277074823685`*^9, 3.5623314218246703`*^9, 3.562333292782156*^9, 
   3.562333553103413*^9, 3.562334600215454*^9, 3.5623350181958804`*^9, 
   3.5623466300810175`*^9, 3.5623466809751067`*^9, 3.562346798993312*^9, 
   3.562363212793419*^9, 3.5623639642311387`*^9, 3.5623640162728305`*^9, 
   3.562364114599803*^9, 3.562364207825567*^9, 3.5623642552028503`*^9, 
   3.5623647028176355`*^9, 3.5624170532897077`*^9, 3.562418586585889*^9, 
   3.562419408987735*^9, 3.562419889234578*^9, 3.562419979574337*^9, 
   3.5624204525610743`*^9, 3.5624205789524965`*^9, 3.562420688043488*^9, 
   3.5624207714880342`*^9, 3.5624333416380053`*^9, 3.5624335092759*^9, 
   3.5624347105380125`*^9, 3.562434936327635*^9, 3.562435345531954*^9, 
   3.562455360708047*^9, 3.562456902174755*^9, 3.562457476584818*^9, 
   3.5624577894617696`*^9, 3.5624578767751226`*^9, 3.5624580187197723`*^9, 
   3.5626169884446783`*^9, 3.5626172243014927`*^9, 3.5626172572487507`*^9, 
   3.56261744481308*^9, 3.5628833896970215`*^9, 3.5629740718652096`*^9, 
   3.5629750607041464`*^9, 3.5629753839991145`*^9, 3.5629755875170717`*^9, 
   3.5629756528811865`*^9, 3.563019195179528*^9, 3.563019225895982*^9, 
   3.5630193630142317`*^9, 3.563019722329663*^9, 3.563033129389307*^9, 
   3.5630341751408167`*^9, 3.5630343239026785`*^9, 3.56303443829688*^9, 
   3.5630345756395206`*^9, 3.563106953825659*^9, 3.5631072252973356`*^9, 
   3.5631078115029707`*^9, 3.5631079889064827`*^9, 3.563108062023811*^9, 
   3.563108325274273*^9, 3.563108483868932*^9, 3.5631090118506594`*^9, 
   3.563109254883486*^9, 3.563110491560058*^9, 3.5631106737683783`*^9, 
   3.5631109837097225`*^9, 3.5631115354514914`*^9, 3.563111685726556*^9, 
   3.5631119178549633`*^9, 3.563197668270113*^9, 3.563230194456465*^9, 
   3.5632304218740654`*^9, 3.5633193896642013`*^9, 3.5633210619684515`*^9, 
   3.5633211532130117`*^9, 3.5633212780288315`*^9, 3.563321459847151*^9, 
   3.563321629934249*^9, 3.5633216664383135`*^9, {3.5633217402264433`*^9, 
   3.563321769039694*^9}, 3.563321807259761*^9, 3.563322720098586*^9, 
   3.563402461401488*^9, 3.575578350141872*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"first", " ", "coord", " ", "is", " ", "position"}], ",", 
   RowBox[{
   "second", " ", "coord", " ", "is", " ", "number", " ", "of", " ", "seats", 
    " ", "already", " ", "assigned"}], ",", " ", 
   RowBox[{
   "third", " ", "cooord", " ", "is", " ", "number", " ", "of", " ", 
    "votes"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.5622601338964186`*^9, 3.5622601359712224`*^9}, 
   3.56226019748213*^9}],

Cell[BoxData[
 RowBox[{"lst2", ":=", 
  RowBox[{"epsetup", "[", "example2prelist", "]"}]}]], "Input",
 CellChangeTimes->{{3.5630345148462143`*^9, 3.563034529042239*^9}}],

Cell[CellGroupData[{

Cell[BoxData["lst2"], "Input",
 CellChangeTimes->{{3.563034531085843*^9, 3.5630345317566442`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "9567", ",", "0", ",", "9567"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7633", ",", "0", ",", "7633"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6112", ",", "0", ",", "6112"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2003", ",", "0", ",", "2003"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1598", ",", "0", ",", "1598"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.563034533145046*^9, 3.5630345757799215`*^9, 3.563106953934859*^9, 
   3.5631072254065356`*^9, 3.5631078116277714`*^9, 3.563107989031283*^9, 
   3.563108062133011*^9, 3.5631083253834734`*^9, 3.5631084839937325`*^9, 
   3.5631090120534596`*^9, 3.5631092550082865`*^9, 3.563110491669258*^9, 
   3.563110673908778*^9, 3.5631109838501225`*^9, 3.563111535576292*^9, 
   3.5631116858357553`*^9, 3.5631119179641633`*^9, 3.5631976683793135`*^9, 
   3.5632301945656652`*^9, 3.563230421967665*^9, 3.5633193897734013`*^9, 
   3.563321062093252*^9, 3.563321153306612*^9, 3.563321278153631*^9, 
   3.563321460018751*^9, 3.5633216300434494`*^9, 3.5633216665631137`*^9, {
   3.5633217403356433`*^9, 3.5633217691644936`*^9}, 3.563321807384561*^9, 
   3.5633227202077866`*^9, 3.5634024614994936`*^9, 3.5755783502042723`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"slst1", ":=", 
  RowBox[{"sepsetup", "[", "example1prelist", "]"}]}]], "Input",
 CellChangeTimes->{{3.562363182264166*^9, 3.562363205757807*^9}, {
  3.5630343866459885`*^9, 3.563034390811196*^9}}],

Cell[CellGroupData[{

Cell[BoxData["slst1"], "Input",
 CellChangeTimes->{{3.562363375579705*^9, 3.562363376796507*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "5567", ",", "1", ",", "3936.46345086551`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7775", ",", "1", ",", "5497.755223725407`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4435", ",", "1", ",", "3136.018574562338`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "7800", ",", "1", ",", "5515.432893255071`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3000", ",", "1", ",", "2121.320343559643`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.562363379230111*^9, 3.562363964277939*^9, 3.5623640163040304`*^9, 
   3.562364114646603*^9, 3.5623642078567667`*^9, 3.56236425523405*^9, 
   3.5623647028644357`*^9, 3.5624170533833075`*^9, 3.5624185866950893`*^9, 
   3.562419409096935*^9, 3.5624198893593783`*^9, 3.562419979683537*^9, 
   3.562420452685875*^9, 3.5624205790616965`*^9, 3.562420688152688*^9, 
   3.562420771612835*^9, 3.5624333417940063`*^9, 3.5624335093851004`*^9, 
   3.562434710647213*^9, 3.562434936468035*^9, 3.562435345641154*^9, 
   3.562455360848447*^9, 3.5624569022839546`*^9, 3.5624574767252183`*^9, 
   3.5624577895709696`*^9, 3.562457876884323*^9, 3.5624580188289723`*^9, 
   3.562616988553879*^9, 3.5626172244106927`*^9, 3.5626172573579507`*^9, 
   3.5626174449222803`*^9, 3.5628833897906218`*^9, 3.56297407197441*^9, 
   3.562975060813347*^9, 3.5629753841083145`*^9, 3.562975587626272*^9, 
   3.562975652990387*^9, 3.5630191953355284`*^9, 3.5630192260051823`*^9, 
   3.563019363139032*^9, 3.563019722454463*^9, 3.5630331295141068`*^9, 
   3.563034175281217*^9, 3.5630343240118785`*^9, 3.56303443839048*^9, 
   3.5630345758735213`*^9, 3.563106954028459*^9, 3.563107225500136*^9, 
   3.563107811721371*^9, 3.5631079891248827`*^9, 3.563108062226611*^9, 
   3.5631083254614735`*^9, 3.5631084840873327`*^9, 3.56310901225626*^9, 
   3.5631092550862865`*^9, 3.5631104917628584`*^9, 3.5631106740179787`*^9, 
   3.563110983959323*^9, 3.5631115356698923`*^9, 3.563111685913756*^9, 
   3.5631119180577636`*^9, 3.5631976684729137`*^9, 3.5632301946592655`*^9, 
   3.5632304220456657`*^9, 3.5633193898514013`*^9, 3.563321062186852*^9, 
   3.563321153384612*^9, 3.5633212782628317`*^9, 3.563321460096751*^9, 
   3.5633216301214495`*^9, 3.5633216666567135`*^9, {3.563321740429243*^9, 
   3.563321769242494*^9}, 3.563321807478161*^9, 3.5633227202857866`*^9, 
   3.563402461571498*^9, 3.5755783502354727`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Initial definitions", "Subsection",
 CellChangeTimes->{{3.5623497961625395`*^9, 3.5623498089077616`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "the", " ", "list", " ", "l", " ", "below", " ", "must", " ", "be", " ", 
   "manufactured", " ", "by", " ", "startlist"}], "*)"}]], "Input",
 CellChangeTimes->{{3.561825643209011*^9, 3.5618256619914436`*^9}, {
  3.5622602123489566`*^9, 3.5622602131289577`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"singleout", "[", "l_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Select", "[", 
    RowBox[{"l", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "==", 
       RowBox[{"Max", "[", 
        RowBox[{"l", "[", 
         RowBox[{"[", 
          RowBox[{"All", ",", "4"}], "]"}], "]"}], "]"}]}], "&"}], ",", "1"}],
     "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5609497337783995`*^9, 3.560949789813698*^9}, {
  3.5609498243521585`*^9, 3.5609498258341613`*^9}, {3.560951229067428*^9, 
  3.5609512315790324`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"singleout", "[", "lst1", "]"}]], "Input",
 CellChangeTimes->{{3.562260429501338*^9, 3.5622604374573517`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "7800", ",", "0", ",", "7800"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5622604389081545`*^9, 3.562261245944372*^9, 3.562261391243027*^9, 
   3.5622614372631083`*^9, 3.562261645951475*^9, 3.5622618341346054`*^9, 
   3.5622619532564144`*^9, 3.562262983529024*^9, 3.5622656577249303`*^9, 
   3.562265985060305*^9, 3.5622660877396855`*^9, 3.5622661696242294`*^9, 
   3.5622663010544605`*^9, 3.5622666380062523`*^9, 3.5622670470077705`*^9, 
   3.562279437801646*^9, 3.5622801805969505`*^9, 3.5622802274750333`*^9, 
   3.5623240055882654`*^9, 3.562325042277686*^9, 3.562325111120607*^9, 
   3.5623253386158066`*^9, 3.5623256206003017`*^9, 3.56232608596472*^9, 
   3.5623264330497293`*^9, 3.562327275511609*^9, 3.562327707529168*^9, 
   3.562331422011871*^9, 3.562333292938156*^9, 3.5623335532438135`*^9, 
   3.5623346004026546`*^9, 3.5623350183538895`*^9, 3.5623466302214174`*^9, 
   3.562346681115507*^9, 3.56234679913332*^9, 3.562363212855819*^9, 
   3.5623639643091393`*^9, 3.56236401635083*^9, 3.562364114677803*^9, 
   3.562364207903567*^9, 3.56236425526525*^9, 3.562364702911236*^9, 
   3.562417053492508*^9, 3.562418586788689*^9, 3.562419409206135*^9, 
   3.5624198894841785`*^9, 3.562419979808337*^9, 3.5624204528106747`*^9, 
   3.562420579155297*^9, 3.5624206882462883`*^9, 3.5624207717376347`*^9, 
   3.5624333419344063`*^9, 3.5624335094787006`*^9, 3.5624347107564125`*^9, 
   3.5624349365928354`*^9, 3.562435345750354*^9, 3.562455361160448*^9, 
   3.562456902377555*^9, 3.5624574768500185`*^9, 3.56245778971137*^9, 
   3.562457876993523*^9, 3.5624580189537725`*^9, 3.562616988709879*^9, 
   3.562617224519893*^9, 3.562617257482751*^9, 3.5626174450314803`*^9, 
   3.562883389899822*^9, 3.5629740721148105`*^9, 3.562975060938147*^9, 
   3.5629753842331147`*^9, 3.5629755877510724`*^9, 3.5629756530995874`*^9, 
   3.563019195460328*^9, 3.563019226145582*^9, 3.5630193632794323`*^9, 
   3.5630197225636635`*^9, 3.5630331306685085`*^9, 3.5630341754372177`*^9, 
   3.5630343241210785`*^9, 3.56303443849968*^9, 3.5630345759827213`*^9, 
   3.5631069541688595`*^9, 3.563107225624936*^9, 3.5631078118461714`*^9, 
   3.563107989234083*^9, 3.5631080623202114`*^9, 3.563108325570674*^9, 
   3.5631084842121325`*^9, 3.5631090125058603`*^9, 3.5631092552110863`*^9, 
   3.563110491887659*^9, 3.563110674173979*^9, 3.563110984084123*^9, 
   3.5631115357790923`*^9, 3.5631116860541563`*^9, 3.563111918151364*^9, 
   3.563197668597714*^9, 3.5632301947684655`*^9, 3.5632304221860657`*^9, 
   3.5633193900074015`*^9, 3.5633210623272524`*^9, 3.5633211534782124`*^9, 
   3.563321278403232*^9, 3.563321460205951*^9, 3.56332163024625*^9, 
   3.563321666765914*^9, {3.563321740554044*^9, 3.563321769351694*^9}, 
   3.5633218076029615`*^9, 3.563322720394987*^9, 3.563402461699505*^9, 
   3.5755783502978725`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"epwt", "[", 
   RowBox[{"p_", ",", "n_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"n", "\[Equal]", "0"}], ",", "p", ",", 
    RowBox[{
     RowBox[{"p", "/", 
      RowBox[{"Sqrt", "[", 
       RowBox[{"n", 
        RowBox[{"(", 
         RowBox[{"n", "+", "1"}], ")"}]}], "]"}]}], "//", "N"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5608987808662205`*^9, 3.560898839522323*^9}, {
  3.5609411884573035`*^9, 3.5609412002197237`*^9}, {3.5609412432289996`*^9, 
  3.560941256489023*^9}, {3.562260491043446*^9, 3.562260492166648*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"epwt", "[", 
    RowBox[{"7800", ",", "#"}], "]"}], "&"}], "/@", 
  RowBox[{"Range", "[", 
   RowBox[{"0", ",", "5"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.561823641071087*^9, 3.561823692613577*^9}, {
  3.562260497143057*^9, 3.562260497938658*^9}, {3.56226096592388*^9, 
  3.5622609660174804`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "7800", ",", "5515.432893255071`", ",", "3184.336665618131`", ",", 
   "2251.6660498395404`", ",", "1744.133022449836`", ",", 
   "1424.0786495134319`"}], "}"}]], "Output",
 CellChangeTimes->{{3.561823674907546*^9, 3.561823693767979*^9}, 
   3.5618237619712987`*^9, 3.5618243630559545`*^9, 3.5618253208032446`*^9, 
   3.5618257560440087`*^9, 3.5618276450337267`*^9, 3.561850528478458*^9, 
   3.561895216321232*^9, 3.5618953420418525`*^9, 3.5618959206924458`*^9, 
   3.5619058906581182`*^9, 3.5619134978973074`*^9, 3.561925095093252*^9, 
   3.5619257383603816`*^9, 3.561925871366215*^9, 3.561926289146949*^9, 
   3.561927460877407*^9, 3.561927679792591*^9, 3.561927758354329*^9, 
   3.561928283076851*^9, 3.5619290476777945`*^9, 3.5619847680100794`*^9, 
   3.5619848364786*^9, 3.561986520439743*^9, 3.5619869836202354`*^9, 
   3.5620689681029787`*^9, 3.5620693974087477`*^9, 3.56207005689916*^9, 
   3.5622598392899017`*^9, 3.5622605091394777`*^9, {3.562260957453065*^9, 
   3.562260966984682*^9}, 3.56226106822886*^9, 3.562261246053572*^9, 
   3.5622613913678274`*^9, 3.5622614373567085`*^9, 3.5622616460450745`*^9, 
   3.5622618342594056`*^9, 3.562261953381215*^9, 3.562262983607024*^9, 
   3.5622656578029304`*^9, 3.562265985153906*^9, 3.562266087817686*^9, 
   3.5622661697178297`*^9, 3.56226630116366*^9, 3.5622666380842524`*^9, 
   3.562267047116971*^9, 3.5622794379264464`*^9, 3.562280180706151*^9, 
   3.562280227568633*^9, 3.5623240056194654`*^9, 3.562325042308886*^9, 
   3.5623251111362066`*^9, 3.5623253386314063`*^9, 3.562325620615902*^9, 
   3.5623260859803195`*^9, 3.5623264330809293`*^9, 3.5623272755584087`*^9, 
   3.5623277075447683`*^9, 3.562331422121071*^9, 3.562333293078557*^9, 
   3.562333553337414*^9, 3.562334600511855*^9, 3.5623350184518948`*^9, 
   3.5623466303150177`*^9, 3.5623466812247076`*^9, 3.562346799230325*^9, 
   3.562363212887019*^9, 3.562363964340339*^9, 3.5623640163820305`*^9, 
   3.5623641146934032`*^9, 3.5623642079191666`*^9, 3.56236425529645*^9, 
   3.5623647029268355`*^9, 3.562417053570508*^9, 3.56241858688229*^9, 
   3.562419409284135*^9, 3.562419889577779*^9, 3.5624199798863373`*^9, 
   3.562420452919875*^9, 3.562420579233297*^9, 3.5624206883242884`*^9, 
   3.562420771846835*^9, 3.5624333420436063`*^9, 3.5624335095567007`*^9, 
   3.5624347108500133`*^9, 3.5624349366864357`*^9, 3.562435345828354*^9, 
   3.5624553612540483`*^9, 3.562456902471155*^9, 3.562457476959219*^9, 
   3.562457791442973*^9, 3.5624578770871234`*^9, 3.562458019062973*^9, 
   3.5626169888190794`*^9, 3.562617224613493*^9, 3.562617257576351*^9, 
   3.562617445125081*^9, 3.5628833899778223`*^9, 3.5629740722084103`*^9, 
   3.562975061016147*^9, 3.5629753843111153`*^9, 3.5629755878290725`*^9, 
   3.562975653193187*^9, 3.563019195663129*^9, 3.5630192262391825`*^9, 
   3.5630193633730326`*^9, 3.5630197226416636`*^9, 3.5630331307621093`*^9, 
   3.563034175624418*^9, 3.563034324214679*^9, 3.5630344385776806`*^9, 
   3.5630345760607214`*^9, 3.56310695434046*^9, 3.5631072257185364`*^9, 
   3.5631078123921723`*^9, 3.5631079893120832`*^9, 3.5631080623982115`*^9, 
   3.563108325648674*^9, 3.5631084843057327`*^9, 3.563109012693061*^9, 
   3.5631092553514867`*^9, 3.563110492012459*^9, 3.563110674329979*^9, 
   3.563110984193323*^9, 3.563111535872692*^9, 3.5631116861633563`*^9, 
   3.5631119182449636`*^9, 3.5631976686913137`*^9, 3.5632301948620653`*^9, 
   3.563230422279666*^9, 3.563319390085402*^9, 3.563321062514453*^9, 
   3.5633211535718126`*^9, 3.5633212785280323`*^9, 3.5633214602839513`*^9, 
   3.56332163033985*^9, 3.563321666859514*^9, {3.563321740647644*^9, 
   3.5633217694452944`*^9}, 3.5633218077121615`*^9, 3.5633227204885874`*^9, 
   3.563402461809511*^9, 3.575578350344672*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"epchangeone", "[", "item_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"item", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ",", 
    RowBox[{"item", "[", 
     RowBox[{"[", "2", "]"}], "]"}], ",", 
    RowBox[{
     RowBox[{"item", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "+", "1"}], ",", 
    RowBox[{"epwt", "[", 
     RowBox[{
      RowBox[{"item", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"item", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "+", "1"}]}], "]"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{
  3.560949203526668*^9, {3.560949841699389*^9, 3.5609498478613997`*^9}, {
   3.5609505185173798`*^9, 3.5609505733982763`*^9}, {3.560950655891221*^9, 
   3.560950707542912*^9}, {3.560950866241991*^9, 3.5609511166692305`*^9}, {
   3.560951157775303*^9, 3.560951180488943*^9}, {3.5609590596897693`*^9, 
   3.5609591277826653`*^9}, {3.560959175714057*^9, 3.560959176214058*^9}, {
   3.560959230085388*^9, 3.560959285901581*^9}, {3.5609593176643815`*^9, 
   3.560959329484398*^9}, 3.5609594733819976`*^9, {3.560959507502045*^9, 
   3.560959521795082*^9}, 3.561225676886918*^9, {3.5622605032114677`*^9, 
   3.562260504116269*^9}, {3.562260597232833*^9, 3.5622606119280586`*^9}, {
   3.5622606553429346`*^9, 3.562260687385391*^9}, {3.562260769082734*^9, 
   3.5622607751355453`*^9}, {3.562261092767703*^9, 3.562261095388508*^9}, 
   3.562261383489814*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"epchangeone", "[", 
  RowBox[{"{", 
   RowBox[{"4", ",", "7800", ",", "0", ",", "7800"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.5622607811259556`*^9, 3.5622608064604*^9}, 
   3.562260863728101*^9, 3.5622613835054135`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "7800", ",", "1", ",", "5515.432893255071`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.562260806990801*^9, 3.5622608650073028`*^9, {3.562261078400078*^9, 
   3.5622610991637144`*^9}, 3.562261246162772*^9, 3.5622613914926276`*^9, 
   3.562261437465908*^9, 3.562261646154275*^9, 3.5622618343686056`*^9, 
   3.5622619534904146`*^9, 3.5622629836850243`*^9, 3.562265657896531*^9, 
   3.562265985231906*^9, 3.562266087880086*^9, 3.56226616981143*^9, 
   3.562266301257261*^9, 3.5622666381778526`*^9, 3.5622670472105713`*^9, 
   3.5622794380356464`*^9, 3.5622801807997513`*^9, 3.5622802276778336`*^9, 
   3.5623240056506653`*^9, 3.562325042324486*^9, 3.562325111167407*^9, 
   3.5623253386626062`*^9, 3.5623256206471024`*^9, 3.5623260860115194`*^9, 
   3.562326433112129*^9, 3.562327275589609*^9, 3.5623277075759687`*^9, 
   3.562331422214671*^9, 3.5623332931877565`*^9, 3.562333553431014*^9, 
   3.5623346006054554`*^9, 3.5623350185459003`*^9, 3.562346630408618*^9, 
   3.562346681318308*^9, 3.5623467993273306`*^9, 3.562363212918219*^9, 
   3.562363964371539*^9, 3.562364016413231*^9, 3.562364114724603*^9, 
   3.562364207950367*^9, 3.56236425531205*^9, 3.5623647029580355`*^9, 
   3.562417053632908*^9, 3.56241858696029*^9, 3.562419409362135*^9, 
   3.562419889671379*^9, 3.5624199799799376`*^9, 3.562420452997875*^9, 
   3.562420579311297*^9, 3.562420688402289*^9, 3.5624207719404354`*^9, 
   3.5624333421372066`*^9, 3.562433509634701*^9, 3.562434710943613*^9, 
   3.562434936764436*^9, 3.562435345921954*^9, 3.5624553614100485`*^9, 
   3.5624569025647554`*^9, 3.5624574770528193`*^9, 3.5624577915989733`*^9, 
   3.5624578771807237`*^9, 3.5624580191721725`*^9, 3.562616988943879*^9, 
   3.5626172247070932`*^9, 3.5626172576699514`*^9, 3.562617445203081*^9, 
   3.5628833900714226`*^9, 3.5629740723020105`*^9, 3.562975061109747*^9, 
   3.5629753844047155`*^9, 3.5629755879226723`*^9, 3.5629756532711873`*^9, 
   3.563019195756729*^9, 3.5630192263327827`*^9, 3.563019363466633*^9, 
   3.563019722735264*^9, 3.563033130855709*^9, 3.563034175718018*^9, 
   3.563034324308279*^9, 3.5630344386556807`*^9, 3.563034576247922*^9, 
   3.56310695444966*^9, 3.563107225843336*^9, 3.5631078131877737`*^9, 
   3.5631079893900833`*^9, 3.5631080624918118`*^9, 3.5631083257422743`*^9, 
   3.563108484399333*^9, 3.563109012911461*^9, 3.5631092566774893`*^9, 
   3.5631104921216593`*^9, 3.563110674423579*^9, 3.5631109843493233`*^9, 
   3.5631115360286922`*^9, 3.5631116862725563`*^9, 3.563111918338564*^9, 
   3.5631976688317146`*^9, 3.563230194940066*^9, 3.563230422388866*^9, 
   3.563319390179002*^9, 3.5633210626236525`*^9, 3.5633211536498127`*^9, 
   3.563321278668432*^9, 3.563321460361952*^9, 3.56332163041785*^9, 
   3.5633216669687147`*^9, {3.563321740756844*^9, 3.5633217695544944`*^9}, 
   3.563321807852562*^9, 3.5633227205665874`*^9, 3.5634024619955215`*^9, 
   3.5755783503914723`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pickit", "[", "l_", "]"}], ":=", 
  RowBox[{"epchangeone", "[", 
   RowBox[{"singleout", "[", "l", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5609658368661003`*^9, 3.560965864665349*^9}, 
   3.5612256769181185`*^9, 3.5622613835366135`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"pickit", "[", "lst1", "]"}]], "Input",
 CellChangeTimes->{{3.5622611580850177`*^9, 3.5622611642782288`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"4", ",", "7800", ",", "1", ",", "5515.432893255071`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.56226116510503*^9, 3.562261246287573*^9, 3.562261391601828*^9, 
   3.5622614375751085`*^9, 3.562261646247875*^9, 3.562261834477806*^9, 
   3.562261953584015*^9, 3.5622629837630243`*^9, 3.562265658021331*^9, 
   3.562265985309906*^9, 3.562266087958086*^9, 3.56226616988943*^9, 
   3.562266301366461*^9, 3.5622666382558527`*^9, 3.5622670473197713`*^9, 
   3.562279438160447*^9, 3.5622801809089513`*^9, 3.562280227771434*^9, 
   3.5623240056662655`*^9, 3.562325042355686*^9, 3.5623251111830072`*^9, 
   3.5623253386938066`*^9, 3.5623256206783023`*^9, 3.56232608604272*^9, 
   3.562326433143329*^9, 3.5623272756364093`*^9, 3.562327707607168*^9, 
   3.5623314223082714`*^9, 3.562333293296957*^9, 3.5623335535246143`*^9, 
   3.5623346007146554`*^9, 3.562335018639906*^9, 3.5623466305022182`*^9, 
   3.5623466814119077`*^9, 3.562346799422336*^9, 3.5623632129494195`*^9, 
   3.5623639643871393`*^9, 3.5623640164444304`*^9, 3.562364114755803*^9, 
   3.562364207981567*^9, 3.5623642553432503`*^9, 3.562364702989236*^9, 
   3.5624170537109084`*^9, 3.5624185870382895`*^9, 3.5624194094401355`*^9, 
   3.5624198897649794`*^9, 3.5624199800891376`*^9, 3.5624204530914755`*^9, 
   3.5624205793736973`*^9, 3.5624206884802885`*^9, 3.5624207720184355`*^9, 
   3.5624333423244066`*^9, 3.562433509728301*^9, 3.562434711021613*^9, 
   3.562434936842436*^9, 3.562435345999954*^9, 3.5624553615036483`*^9, 
   3.5624569026427555`*^9, 3.562457477193219*^9, 3.5624577917393737`*^9, 
   3.5624578772743235`*^9, 3.562458019281373*^9, 3.5626169890530796`*^9, 
   3.5626172247850933`*^9, 3.5626172577479515`*^9, 3.5626174452810807`*^9, 
   3.5628833901494226`*^9, 3.5629740750164156`*^9, 3.5629750612033477`*^9, 
   3.562975384482715*^9, 3.5629755880162725`*^9, 3.5629756533647876`*^9, 
   3.5630191958503294`*^9, 3.563019226426383*^9, 3.5630193644182343`*^9, 
   3.563019722828864*^9, 3.5630331309493093`*^9, 3.5630341758428183`*^9, 
   3.5630343244018793`*^9, 3.5630344387336807`*^9, 3.5630345763571224`*^9, 
   3.56310695455886*^9, 3.5631072259369364`*^9, 3.563107818366983*^9, 
   3.5631079894680834`*^9, 3.563108062585412*^9, 3.5631083258358746`*^9, 
   3.563108484539733*^9, 3.5631090130986614`*^9, 3.563109260546296*^9, 
   3.5631104922308593`*^9, 3.5631106745327797`*^9, 3.5631109844429235`*^9, 
   3.5631115361222925`*^9, 3.5631116864129567`*^9, 3.5631119184789643`*^9, 
   3.5631976689253144`*^9, 3.5632301950804663`*^9, 3.5632304225292664`*^9, 
   3.5633193902570024`*^9, 3.563321062732853*^9, 3.5633211537122126`*^9, 
   3.5633212787932324`*^9, 3.5633214604711514`*^9, 3.5633216305114503`*^9, 
   3.5633216670935144`*^9, {3.563321740850444*^9, 3.5633217696792946`*^9}, 
   3.563321807961762*^9, 3.5633227207225876`*^9, 3.5634024620995274`*^9, 
   3.5755783504538727`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"update", "[", "l_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"li", "=", 
      RowBox[{"ReplacePart", "[", 
       RowBox[{"l", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"pickit", "[", "l", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
         RowBox[{"pickit", "[", "l", "]"}]}]}], "]"}]}], "}"}], ",", 
    RowBox[{"Return", "[", "li", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.560984939881503*^9, 3.5609849827971783`*^9}, {
  3.560985018318441*^9, 3.560985088471764*^9}, {3.5609851213566217`*^9, 
  3.5609853061389465`*^9}, {3.560985340661807*^9, 3.5609853460906167`*^9}, {
  3.560985417070741*^9, 3.5609854484267964`*^9}, {3.5609855521981783`*^9, 
  3.5609855552713842`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"update", "[", "lst1", "]"}]], "Input",
 CellChangeTimes->{{3.5622656461185102`*^9, 3.5622656508921185`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "5567", ",", "0", ",", "5567"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7775", ",", "0", ",", "7775"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4435", ",", "0", ",", "4435"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "7800", ",", "1", ",", "5515.432893255071`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3000", ",", "0", ",", "3000"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.562265652483321*^9, 3.562265671499755*^9}, 
   3.5622659854035063`*^9, 3.562266088036086*^9, 3.5622661701546307`*^9, 
   3.562266301460061*^9, 3.562266638333853*^9, 3.5622670474289713`*^9, 
   3.562279438347647*^9, 3.5622801810337515`*^9, 3.562280227865034*^9, 
   3.562324005697466*^9, 3.562325042371286*^9, 3.5623251112142067`*^9, 
   3.5623253387250066`*^9, 3.5623256206939025`*^9, 3.5623260860739193`*^9, 
   3.562326433174529*^9, 3.5623272756832094`*^9, 3.5623277076383686`*^9, 
   3.562331422417472*^9, 3.5623332934061575`*^9, 3.5623335536182137`*^9, 
   3.5623346008238554`*^9, 3.562335018734911*^9, 3.5623466305958185`*^9, 
   3.5623466814899077`*^9, 3.5623467995213423`*^9, 3.562363212965019*^9, 
   3.5623639644183393`*^9, 3.5623640164756308`*^9, 3.5623641147714033`*^9, 
   3.562364207997167*^9, 3.5623642553744507`*^9, 3.562364703020436*^9, 
   3.5624170537889085`*^9, 3.56241858711629*^9, 3.5624194095493355`*^9, 
   3.562419889858579*^9, 3.562419980167138*^9, 3.5624204532318754`*^9, 
   3.5624205794516973`*^9, 3.562420688573889*^9, 3.5624207721744356`*^9, 
   3.562433342433607*^9, 3.562433509806301*^9, 3.5624347111152134`*^9, 
   3.562434936982836*^9, 3.5624353460779543`*^9, 3.562455361581649*^9, 
   3.562456902736356*^9, 3.5624574772712193`*^9, 3.5624577918485737`*^9, 
   3.5624578773679237`*^9, 3.562458019406173*^9, 3.5626169891622796`*^9, 
   3.5626172248786936`*^9, 3.5626172579039516`*^9, 3.562617445421481*^9, 
   3.5628833902274227`*^9, 3.5629740756872163`*^9, 3.5629750612969475`*^9, 
   3.562975384576316*^9, 3.562975588109873*^9, 3.562975653458388*^9, 
   3.5630191959439297`*^9, 3.5630192265199833`*^9, 3.5630193645274343`*^9, 
   3.563019722922464*^9, 3.5630331310429096`*^9, 3.5630341759364185`*^9, 
   3.5630343244798794`*^9, 3.563034438811681*^9, 3.5630345764507227`*^9, 
   3.5631069546680603`*^9, 3.5631072260305367`*^9, 3.5631078186789837`*^9, 
   3.563107989577284*^9, 3.563108062694612*^9, 3.563108325945074*^9, 
   3.563108484633333*^9, 3.563109013379462*^9, 3.563109260608696*^9, 
   3.5631104923556595`*^9, 3.56311067478238*^9, 3.563110984536524*^9, 
   3.5631115362002926`*^9, 3.5631116865221567`*^9, 3.563111918572564*^9, 
   3.5631976690189147`*^9, 3.5632301951584663`*^9, 3.5632304226384664`*^9, 
   3.5633193904286027`*^9, 3.563321062857653*^9, 3.5633211538370132`*^9, 
   3.563321278902433*^9, 3.5633214605647516`*^9, 3.5633216306206503`*^9, 
   3.563321667202715*^9, {3.5633217409596443`*^9, 3.563321769772895*^9}, 
   3.563321808086562*^9, 3.5633227208005877`*^9, 3.5634024622045336`*^9, 
   3.575578350500673*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"update", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.562265673543358*^9, 3.5622656760705624`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "5567", ",", "0", ",", "5567"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7775", ",", "1", ",", "5497.755223725407`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4435", ",", "0", ",", "4435"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "7800", ",", "1", ",", "5515.432893255071`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3000", ",", "0", ",", "3000"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.5622656774589653`*^9, 3.562265985465906*^9, 3.5622660880828867`*^9, 
   3.562266170326231*^9, 3.562266301522461*^9, 3.562266638396253*^9, 
   3.5622670474913716`*^9, 3.5622794384256473`*^9, 3.5622801810961514`*^9, 
   3.562280227943034*^9, 3.5623240057286654`*^9, 3.562325042402486*^9, 
   3.562325111229807*^9, 3.562325338740607*^9, 3.562325620709502*^9, 
   3.5623260860895195`*^9, 3.5623264331901293`*^9, 3.562327275714409*^9, 
   3.562327707653969*^9, 3.5623314224798717`*^9, 3.562333293452957*^9, 
   3.5623335536806145`*^9, 3.5623346009018555`*^9, 3.562335018802915*^9, 
   3.5623466306582184`*^9, 3.562346681552308*^9, 3.5623467995783453`*^9, 
   3.5623632129962196`*^9, 3.562363964433939*^9, 3.562364016491231*^9, 
   3.5623641148026037`*^9, 3.562364208028367*^9, 3.5623642553900504`*^9, 
   3.5623647030516357`*^9, 3.562417053851309*^9, 3.5624185871630898`*^9, 
   3.5624194096117353`*^9, 3.5624198899209795`*^9, 3.562419980245138*^9, 
   3.5624204532942753`*^9, 3.5624205794984975`*^9, 3.562420688620689*^9, 
   3.5624207722524357`*^9, 3.562433342496007*^9, 3.5624335098531013`*^9, 
   3.5624347111776133`*^9, 3.562434937045236*^9, 3.562435346140355*^9, 
   3.5624553616440487`*^9, 3.5624569027987556`*^9, 3.5624574773336196`*^9, 
   3.5624577919109735`*^9, 3.562457877445924*^9, 3.5624580194529734`*^9, 
   3.56261698922468*^9, 3.5626172249410934`*^9, 3.562617259011554*^9, 
   3.562617445483881*^9, 3.5628833903678226`*^9, 3.562974075968017*^9, 
   3.562975061359348*^9, 3.5629753846387157`*^9, 3.562975588172273*^9, 
   3.562975653520788*^9, 3.5630191960219297`*^9, 3.5630192266291833`*^9, 
   3.563019364652235*^9, 3.563019722984864*^9, 3.5630331311209097`*^9, 
   3.5630341760144186`*^9, 3.5630343245890794`*^9, 3.5630344388740807`*^9, 
   3.563034576528723*^9, 3.5631069547460604`*^9, 3.5631072261085367`*^9, 
   3.5631078187725835`*^9, 3.5631079896240835`*^9, 3.5631080627570124`*^9, 
   3.5631083260230746`*^9, 3.5631084846957335`*^9, 3.563109013519862*^9, 
   3.5631092615758977`*^9, 3.5631104924336596`*^9, 3.56311067482918*^9, 
   3.5631109845989237`*^9, 3.563111536262693*^9, 3.563111686584557*^9, 
   3.563111918634965*^9, 3.563197669081315*^9, 3.563230195220866*^9, 
   3.5632304227008667`*^9, 3.563319390491003*^9, 3.5633210629356537`*^9, 
   3.563321153899413*^9, 3.563321278964833*^9, 3.5633214606115522`*^9, 
   3.5633216306986504`*^9, 3.563321667265115*^9, {3.5633217410376444`*^9, 
   3.563321769850895*^9}, 3.5633218081489625`*^9, 3.5633227208629875`*^9, 
   3.563402462258537*^9, 3.5755783505318727`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"epapport", "[", 
   RowBox[{"l_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"NestWhile", "[", 
   RowBox[{"update", ",", "l", ",", "1", ",", 
    RowBox[{"seats", "+", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.562261383567814*^9, {3.5622628902096605`*^9, 3.562262900864479*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"epapport", "[", 
  RowBox[{"lst1", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{3.562262238393715*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "5567", ",", "0", ",", "5567"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7775", ",", "0", ",", "7775"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4435", ",", "0", ",", "4435"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "7800", ",", "0", ",", "7800"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3000", ",", "0", ",", "3000"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.5622622392205167`*^9, 3.5622628798668423`*^9, 3.562262983872225*^9, 
   3.5622656583021317`*^9, 3.5622659855595064`*^9, 3.5622660881608863`*^9, 
   3.5622661717458334`*^9, 3.5622663016316614`*^9, 3.562266638474253*^9, 
   3.5622670475849714`*^9, 3.5622794385348473`*^9, 3.562280181205352*^9, 
   3.5622802280990343`*^9, 3.5623240057598658`*^9, 3.5623250424336863`*^9, 
   3.5623251112610073`*^9, 3.5623253387718067`*^9, 3.5623256207407026`*^9, 
   3.5623260861051197`*^9, 3.5623264332213297`*^9, 3.5623272757456093`*^9, 
   3.5623277076851683`*^9, 3.5623314225890718`*^9, 3.5623332935621576`*^9, 
   3.5623335537742147`*^9, 3.562334601073456*^9, 3.562335018900921*^9, 
   3.5623466307518187`*^9, 3.5623466816459084`*^9, 3.5623467996743507`*^9, 
   3.56236321301182*^9, 3.5623639644651394`*^9, 3.562364016522431*^9, 
   3.5623641148182034`*^9, 3.5623642080439672`*^9, 3.56236425540565*^9, 
   3.562364703067236*^9, 3.562417053929309*^9, 3.56241858725669*^9, 
   3.562419409767736*^9, 3.5624198900457797`*^9, 3.562419980354338*^9, 
   3.562420453387876*^9, 3.5624205795764976`*^9, 3.562420688745489*^9, 
   3.562420772346036*^9, 3.562433342574007*^9, 3.562433509931101*^9, 
   3.562434711255614*^9, 3.5624349372168365`*^9, 3.562435346265155*^9, 
   3.562455361737649*^9, 3.562456902939156*^9, 3.5624574774272194`*^9, 
   3.562457792020174*^9, 3.562457877539524*^9, 3.562458019562174*^9, 
   3.56261698933388*^9, 3.562617225065894*^9, 3.562617259167554*^9, 
   3.562617445561881*^9, 3.5628833904458227`*^9, 3.5629740760928173`*^9, 
   3.562975061484148*^9, 3.5629753847479157`*^9, 3.562975588281473*^9, 
   3.562975653645588*^9, 3.5630191961155295`*^9, 3.563019226722783*^9, 
   3.563019364745835*^9, 3.5630197230940647`*^9, 3.56303313123011*^9, 
   3.563034176139219*^9, 3.5630343246826797`*^9, 3.563034439014481*^9, 
   3.5630345766535225`*^9, 3.5631069548396606`*^9, 3.5631072261865373`*^9, 
   3.5631078188973837`*^9, 3.563107989967284*^9, 3.5631080628506126`*^9, 
   3.5631083261010747`*^9, 3.5631084848049335`*^9, 3.5631090137070627`*^9, 
   3.563109262012698*^9, 3.56311049254286*^9, 3.56311067490718*^9, 
   3.563110984692524*^9, 3.563111536356293*^9, 3.563111686693757*^9, 
   3.5631119199141665`*^9, 3.563197669159315*^9, 3.5632301953144665`*^9, 
   3.5632304228100667`*^9, 3.563319390584603*^9, 3.5633210630448537`*^9, 
   3.563321153977413*^9, 3.563321279074033*^9, 3.563321460705152*^9, 
   3.5633216307922506`*^9, 3.563321667358715*^9, {3.563321741146845*^9, 
   3.563321769944495*^9}, 3.5633218082737627`*^9, 3.563322720940988*^9, 
   3.563402462387544*^9, 3.5755783505942726`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"epapport", "[", 
  RowBox[{"lst1", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{3.562262251513338*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "5567", ",", "0", ",", "5567"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7775", ",", "0", ",", "7775"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4435", ",", "0", ",", "4435"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "7800", ",", "1", ",", "5515.432893255071`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3000", ",", "0", ",", "3000"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.562262252106139*^9, 3.5622628939380665`*^9, 3.5622629839190245`*^9, 
   3.562265658395732*^9, 3.5622659856375065`*^9, 3.5622660882076864`*^9, 
   3.5622661720110335`*^9, 3.5622663017564616`*^9, 3.5622666385210533`*^9, 
   3.562267047647372*^9, 3.5622794386128473`*^9, 3.5622801812677517`*^9, 
   3.5622802281770344`*^9, 3.5623240057754655`*^9, 3.5623250424492865`*^9, 
   3.5623251112766075`*^9, 3.562325338787407*^9, 3.5623256207563024`*^9, 
   3.56232608612072*^9, 3.5623264332369294`*^9, 3.5623272757768097`*^9, 
   3.5623277077163687`*^9, 3.562331422651472*^9, 3.5623332936245575`*^9, 
   3.5623335538522143`*^9, 3.562334601151456*^9, 3.562335018971925*^9, 
   3.5623466308142185`*^9, 3.562346681692708*^9, 3.562346799730354*^9, 
   3.5623632130430193`*^9, 3.5623639644963393`*^9, 3.5623640165380306`*^9, 
   3.562364114833803*^9, 3.5623642080595675`*^9, 3.5623642554368505`*^9, 
   3.5623647030984364`*^9, 3.5624170539761086`*^9, 3.56241858730349*^9, 
   3.5624194098301363`*^9, 3.5624198901081796`*^9, 3.5624199804167385`*^9, 
   3.562420453450276*^9, 3.5624205796232977`*^9, 3.5624206888078895`*^9, 
   3.5624207724084363`*^9, 3.5624333426364074`*^9, 3.5624335099935017`*^9, 
   3.562434711349214*^9, 3.5624349372636366`*^9, 3.5624353463275547`*^9, 
   3.562455361800049*^9, 3.562456903001556*^9, 3.5624574774896197`*^9, 
   3.5624577920669737`*^9, 3.5624578776019244`*^9, 3.5624580196245737`*^9, 
   3.5626169893962803`*^9, 3.562617225143894*^9, 3.562617259229954*^9, 
   3.562617445624282*^9, 3.5628833905082235`*^9, 3.5629740761708174`*^9, 
   3.562975061546548*^9, 3.562975384810316*^9, 3.5629755883438735`*^9, 
   3.5629756537079883`*^9, 3.56301919619353*^9, 3.5630192268007836`*^9, 
   3.563019364839435*^9, 3.5630197231720643`*^9, 3.56303313129251*^9, 
   3.563034176217219*^9, 3.5630343247450795`*^9, 3.5630344390768814`*^9, 
   3.5630345767315226`*^9, 3.5631069549176607`*^9, 3.563107226264537*^9, 
   3.563107819958186*^9, 3.563107990029684*^9, 3.5631080629130125`*^9, 
   3.563108326163475*^9, 3.563108484867334*^9, 3.5631090138474627`*^9, 
   3.5631092620750985`*^9, 3.5631104926364603`*^9, 3.5631106749539804`*^9, 
   3.5631109847549243`*^9, 3.5631115364186935`*^9, 3.563111686740557*^9, 
   3.5631119199765673`*^9, 3.563197669221715*^9, 3.5632301953768663`*^9, 
   3.563230422856867*^9, 3.563319390647003*^9, 3.5633210631384535`*^9, 
   3.5633211540398135`*^9, 3.563321279136433*^9, 3.5633214607675524`*^9, 
   3.5633216308702507`*^9, 3.563321667436715*^9, {3.563321741224845*^9, 
   3.5633217700224953`*^9}, 3.5633218083361626`*^9, 3.563322721003388*^9, 
   3.563402462449548*^9, 3.575578350625473*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"epapport", "[", 
  RowBox[{"lst1", ",", "20"}], "]"}]], "Input",
 CellChangeTimes->{{3.5610533192388477`*^9, 3.5610533196756487`*^9}, {
   3.5612250587602324`*^9, 3.5612250593842335`*^9}, 3.561680764924506*^9, 
   3.561925712433136*^9, 3.562261119100549*^9, 3.562261383583414*^9, 
   3.563034716679369*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "5567", ",", "4", ",", "1244.8190430741329`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7775", ",", "5", ",", "1419.5142948675557`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4435", ",", "3", ",", "1280.2742219279953`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "7800", ",", "6", ",", "1203.5661297043168`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3000", ",", "2", ",", "1224.744871391589`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.561489855775119*^9, 3.561489904149207*^9, 3.561502987454935*^9, 
   3.5615033639555964`*^9, 3.561503458834963*^9, 3.5615036582345133`*^9, 
   3.5615042497487526`*^9, 3.5615042983272376`*^9, 3.5615044572915173`*^9, 
   3.561577020283678*^9, 3.5615804595478554`*^9, 3.5615855337319007`*^9, 
   3.5615859645266576`*^9, 3.561588027765694*^9, 3.5615884407364197`*^9, 
   3.561588576139675*^9, 3.5616804628455753`*^9, 3.56168077281812*^9, 
   3.561680931787999*^9, 3.561681063811031*^9, 3.561681366888363*^9, 
   3.561681542841072*^9, 3.5616819666938167`*^9, 3.561722793985258*^9, 
   3.5617230090160356`*^9, 3.561723221230008*^9, 3.5617247380188417`*^9, 
   3.561724791604936*^9, 3.561725201866857*^9, 3.5617428300264397`*^9, 
   3.5617520896722727`*^9, 3.561812859674822*^9, 3.561822835960473*^9, 
   3.5618237622676997`*^9, 3.5618243633055553`*^9, 3.561825321115245*^9, 
   3.561825756293609*^9, 3.5618276452677274`*^9, 3.561850528743658*^9, 
   3.561895216524032*^9, 3.561895342260253*^9, 3.5618959209264464`*^9, 
   3.5619058909701185`*^9, 3.5619134981625075`*^9, 3.5619250953584523`*^9, 
   3.5619257385943823`*^9, 3.5619258715690155`*^9, 3.56192628984895*^9, 
   3.5619274611270075`*^9, 3.561927680042192*^9, 3.5619277585259295`*^9, 
   3.561928283248451*^9, 3.5619290478493943`*^9, 3.5619847681816797`*^9, 
   3.5619848366658*^9, 3.5619865206897573`*^9, 3.561986983818247*^9, 
   3.562068968570979*^9, 3.5620693976271486`*^9, 3.5620700571175604`*^9, 
   3.562259839539502*^9, 3.562261120145751*^9, 3.562261246443573*^9, 
   3.562261391742228*^9, 3.5622614380899096`*^9, 3.5622616464194756`*^9, 
   3.562261834633806*^9, 3.5622619537244153`*^9, 3.5622629044680853`*^9, 
   3.562262983981425*^9, 3.5622656584737315`*^9, 3.5622659857311063`*^9, 
   3.5622660882700863`*^9, 3.5622661724010344`*^9, 3.5622663018188615`*^9, 
   3.562266638583453*^9, 3.562267047709772*^9, 3.5622794387064476`*^9, 
   3.562280181345752*^9, 3.5622802282706347`*^9, 3.5623240057910657`*^9, 
   3.5623250424648867`*^9, 3.5623251112922072`*^9, 3.562325338818607*^9, 
   3.562325620771902*^9, 3.56232608615192*^9, 3.562326433252529*^9, 
   3.56232727579241*^9, 3.562327707731969*^9, 3.562331422791872*^9, 
   3.562333293718158*^9, 3.562333553930215*^9, 3.5623346012294564`*^9, 
   3.5623350191089325`*^9, 3.5623466309390187`*^9, 3.562346681770708*^9, 
   3.5623467997873573`*^9, 3.5623632130586195`*^9, 3.562363964511939*^9, 
   3.562364016569231*^9, 3.5623641148650036`*^9, 3.562364208090767*^9, 
   3.5623642554524508`*^9, 3.562364703114036*^9, 3.562417054100909*^9, 
   3.5624185874282904`*^9, 3.562419409892536*^9, 3.56241989017058*^9, 
   3.5624199804947386`*^9, 3.5624204535126762`*^9, 3.5624205796700974`*^9, 
   3.5624206888546896`*^9, 3.5624207724708366`*^9, 3.5624333426988077`*^9, 
   3.5624335100715017`*^9, 3.562434711411614*^9, 3.5624349372948365`*^9, 
   3.5624353463899555`*^9, 3.562455361878049*^9, 3.5624569030795565`*^9, 
   3.56245747755202*^9, 3.562457792129374*^9, 3.5624578776643243`*^9, 
   3.5624580196869736`*^9, 3.56261698945868*^9, 3.562617225206294*^9, 
   3.562617259292354*^9, 3.562617446716284*^9, 3.5628833905706234`*^9, 
   3.562974076498418*^9, 3.5629750616245484`*^9, 3.562975384888316*^9, 
   3.5629755884218736`*^9, 3.5629756537859883`*^9, 3.56301919625593*^9, 
   3.5630192268631835`*^9, 3.563019364917435*^9, 3.5630197232344646`*^9, 
   3.56303313137051*^9, 3.563034176295219*^9, 3.56303432480748*^9, 
   3.563034439123681*^9, 3.5630345768251233`*^9, 3.5630347172097692`*^9, 
   3.5631069549800606`*^9, 3.563107226342537*^9, 3.563107820098586*^9, 
   3.5631079901076846`*^9, 3.5631080629754124`*^9, 3.563108326241475*^9, 
   3.563108484945334*^9, 3.563109014003463*^9, 3.563109262137499*^9, 
   3.56311049271446*^9, 3.5631106750163803`*^9, 3.5631109848173246`*^9, 
   3.5631115364810934`*^9, 3.5631116868029575`*^9, 3.563111920038967*^9, 
   3.5631976692841153`*^9, 3.5632301954392667`*^9, 3.5632304229192667`*^9, 
   3.563319390709403*^9, 3.563321063216454*^9, 3.563321154102214*^9, 
   3.563321279214433*^9, 3.5633214608299522`*^9, 3.5633216309482512`*^9, 
   3.563321667514715*^9, {3.563321741302845*^9, 3.5633217701004953`*^9}, 
   3.5633218084141626`*^9, 3.5633227210657883`*^9, 3.5634024625035505`*^9, 
   3.5755783506722727`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"epapport", "[", 
  RowBox[{"lst2", ",", "20"}], "]"}]], "Input",
 CellChangeTimes->{{3.5630346954165316`*^9, 3.563034704074547*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "9567", ",", "7", ",", "1278.4441506880821`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7633", ",", "6", ",", "1177.7974702606475`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "6112", ",", "4", ",", "1366.6847478478714`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2003", ",", "2", ",", "817.7213257991177`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1598", ",", "1", ",", "1129.956636336103`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.5630346960717325`*^9, 3.5630347046049476`*^9}, 
   3.5631069576944656`*^9, 3.5631072264049377`*^9, 3.563107820160986*^9, 
   3.563107990170085*^9, 3.5631080630378127`*^9, 3.563108326303875*^9, 
   3.563108485023334*^9, 3.563109014159463*^9, 3.563109262168699*^9, 
   3.5631104927924604`*^9, 3.5631106750943804`*^9, 3.5631109848797245`*^9, 
   3.5631115365434933`*^9, 3.5631116868653574`*^9, 3.563111920101367*^9, 
   3.563197669362115*^9, 3.563230195486067*^9, 3.563230422981667*^9, 
   3.563319390771803*^9, 3.563321063325654*^9, 3.563321154180214*^9, 
   3.5633212792924337`*^9, 3.5633214609547524`*^9, 3.5633216310262513`*^9, 
   3.563321667577115*^9, {3.563321741380845*^9, 3.5633217701628957`*^9}, 
   3.5633218084765625`*^9, 3.5633227211437883`*^9, 3.5634024625575542`*^9, 
   3.575578350703473*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"totvotes", "[", "l_", "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"l", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"eptotvotes", "[", 
   RowBox[{"list_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{
    RowBox[{"epapport", "[", 
     RowBox[{"list", ",", "seats"}], "]"}], "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"quota", "[", 
   RowBox[{"l_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"totvotes", "[", "l", "]"}], "/", "seats"}], "//", 
   "N"}]}]], "Input",
 CellChangeTimes->{{3.5612257232813997`*^9, 3.561225752375451*^9}, {
   3.561225796532443*^9, 3.5612258039424562`*^9}, {3.561225841179722*^9, 
   3.5612258423809233`*^9}, {3.5612260149640265`*^9, 3.561226054931297*^9}, {
   3.561246414851488*^9, 3.561246418863717*^9}, {3.5612465829801044`*^9, 
   3.561246617332069*^9}, 3.561465954931777*^9, {3.56236394781991*^9, 
   3.562363960845933*^9}, {3.562364002139206*^9, 3.56236400500961*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"squota", "[", 
   RowBox[{"l_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"seats", "\[Equal]", "0"}], ",", "\"\<no quota\>\"", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"totvotes", "[", "l", "]"}], "/", "seats"}], "//", "N"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5631084730893135`*^9, 3.563108479578924*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"uquota", "[", 
   RowBox[{"l_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"seats", "\[Equal]", "0"}], ",", "1", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"totvotes", "[", "l", "]"}], "/", "seats"}], "//", "N"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5633212602136*^9, 3.563321272256821*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"totvotes", "[", "l_", "]"}], ":=", 
  RowBox[{"Plus", "@@", 
   RowBox[{"l", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "2"}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5612260592681046`*^9, 3.5612260646657143`*^9}, {
   3.561246113315241*^9, 3.561246134647461*^9}, {3.5612462298769083`*^9, 
   3.561246254071292*^9}, {3.5612463626064997`*^9, 3.5612463647826242`*^9}, 
   3.561465954931777*^9, 3.562280271779111*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weight", "[", 
   RowBox[{"l_", ",", "n_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"seats", "\[Equal]", "0"}], ",", "\"\<no weight\>\"", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"l", "[", 
       RowBox[{"[", "n", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/", 
     RowBox[{"squota", "[", 
      RowBox[{"l", ",", "seats"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.562617333829285*^9, 3.562617337625292*^9}, 
   3.5626173991205997`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ideal", "[", 
   RowBox[{"l_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"q", "=", 
       RowBox[{"squota", "[", 
        RowBox[{"l", ",", "seats"}], "]"}]}], ",", 
      RowBox[{"app", "=", 
       RowBox[{"epapport", "[", 
        RowBox[{"l", ",", "seats"}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"#", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "/", "q"}], "&"}], "/@", "app"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.562324397164553*^9, 3.5623244134665813`*^9}, {
   3.5623244560078564`*^9, 3.562324478300296*^9}, 3.5626172140054746`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ideal", "[", 
  RowBox[{"lst1", ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.5626175191160107`*^9, 3.562617525137621*^9}, 
   3.5631100350564566`*^9, {3.5631100726681223`*^9, 3.5631100882681494`*^9}, {
   3.563110128797021*^9, 3.563110135567433*^9}, 3.563319465168334*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "3.50652622738566`", ",", "4.897295027469644`", ",", "2.793505266473038`", 
   ",", "4.913041956818421`", ",", "1.889631521853239`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.562617526214023*^9, 3.5628833907422237`*^9, 3.562974079790024*^9, 
   3.562975061842949*^9, 3.562975385106716*^9, 3.562975588640274*^9, 
   3.562975654004389*^9, {3.5630191988611345`*^9, 3.563019227097184*^9}, 
   3.5630193651982355`*^9, 3.563019723468465*^9, 3.5630331317449107`*^9, 
   3.5630341766540194`*^9, 3.56303432504148*^9, 3.5630344393420815`*^9, 
   3.5630345770747232`*^9, 3.5631069593948684`*^9, 3.563107226638938*^9, 
   3.5631078205665865`*^9, 3.5631079903572855`*^9, 3.563108063256213*^9, 
   3.563108326522276*^9, 3.563108485382135*^9, 3.5631090147990646`*^9, 
   3.5631092623870993`*^9, 3.5631100358364573`*^9, {3.563110073479324*^9, 
   3.5631100887361507`*^9}, {3.5631101295770226`*^9, 3.5631101359262333`*^9}, 
   3.5631104930888605`*^9, 3.5631106754063807`*^9, 3.5631109858469267`*^9, 
   3.5631115367930937`*^9, 3.563111687192958*^9, 3.5631119203353677`*^9, 
   3.5631976710001183`*^9, 3.563230195735667*^9, 3.5632304232624674`*^9, 
   3.5633193909746037`*^9, 3.5633194659327354`*^9, 3.5633210636688547`*^9, 
   3.563321154414214*^9, 3.5633212798072343`*^9, 3.563321461188753*^9, 
   3.5633216312602515`*^9, 3.5633216678267155`*^9, {3.5633217416460457`*^9, 
   3.563321770396896*^9}, 3.563321808975764*^9, 3.5633227213777885`*^9, 
   3.563402463095585*^9, 3.5755783508282733`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"lst1", "[", 
   RowBox[{"[", "2", "]"}], "]"}], "[", 
  RowBox[{"[", "2", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5633197978077183`*^9, 3.5633198096793385`*^9}, {
  3.5633199141527224`*^9, 3.5633199148859234`*^9}}],

Cell[BoxData["7775"], "Output",
 CellChangeTimes->{{3.5633198033145275`*^9, 3.56331981031894*^9}, 
   3.563319915541125*^9, 3.5633210637312546`*^9, 3.563321154476614*^9, 
   3.5633212799164343`*^9, 3.563321461251153*^9, 3.5633216313070517`*^9, 
   3.563321667873516*^9, {3.5633217417396455`*^9, 3.563321770459296*^9}, 
   3.563321809038164*^9, 3.563322721440189*^9, 3.563402463165589*^9, 
   3.575578350859473*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"7775", "/", "4.8973"}]], "Input",
 CellChangeTimes->{{3.563320033141732*^9, 3.563320039412943*^9}}],

Cell[BoxData["1587.6094991117552`"], "Output",
 CellChangeTimes->{
  3.563320040442545*^9, 3.563321063793655*^9, 3.563321154554614*^9, 
   3.563321280072435*^9, 3.563321461313553*^9, 3.5633216313850517`*^9, 
   3.563321667935916*^9, {3.563321741802046*^9, 3.563321770521696*^9}, 
   3.563321809100564*^9, 3.563322721486989*^9, 3.5634024632535934`*^9, 
   3.5755783508906736`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"squota", "[", 
    RowBox[{"lst1", ",", "18"}], "]"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"lst1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}], "/", 
    RowBox[{
     RowBox[{"ideal", "[", 
      RowBox[{"lst1", ",", "18"}], "]"}], "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}]], "Input",
 CellChangeTimes->{{3.5633198442022*^9, 3.5633198879602766`*^9}, {
  3.563319926788745*^9, 3.563319927599946*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1587.611111111111`", ",", "1587.6111111111109`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.563319956007596*^9, 3.5633210638560553`*^9, 3.563321154632614*^9, 
   3.5633212801504345`*^9, 3.563321461375953*^9, 3.563321631463052*^9, 
   3.563321668013916*^9, {3.5633217418644457`*^9, 3.563321770599696*^9}, 
   3.563321809162964*^9, 3.563322721549389*^9, 3.563402463313597*^9, 
   3.575578350984274*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"preseats", "[", 
   RowBox[{"l_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"Floor", " ", "/@", 
   RowBox[{"ideal", "[", 
    RowBox[{"l", ",", "seats"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.562626064410531*^9, 3.5626261120374146`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"preseats", "[", 
  RowBox[{"lst1", ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.5626261167954226`*^9, 3.5626261261710396`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "4", ",", "2", ",", "4", ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{
  3.562626127029041*^9, 3.5628833908358235`*^9, 3.562974079914824*^9, 
   3.5629750619365487`*^9, 3.5629753852003164`*^9, 3.5629755887338743`*^9, 
   3.562975654097989*^9, {3.5630191990171347`*^9, 3.5630192272063847`*^9}, 
   3.563019365307436*^9, 3.563019723546465*^9, 3.563033131838511*^9, 
   3.56303417676322*^9, 3.5630343251350803`*^9, 3.5630344394200816`*^9, 
   3.563034577215124*^9, 3.5631069597380695`*^9, 3.563107226732538*^9, 
   3.563107820660187*^9, 3.5631079904196854`*^9, 3.5631080633498135`*^9, 
   3.5631083266002755`*^9, 3.5631084854757347`*^9, 3.563109015033065*^9, 
   3.563109262449499*^9, 3.563110493198061*^9, 3.563110676108382*^9, 
   3.563110985956126*^9, 3.5631115368710938`*^9, 3.5631116873021584`*^9, 
   3.5631119204133673`*^9, 3.5631976729189215`*^9, 3.563230195844867*^9, 
   3.563230423371668*^9, 3.563319391068204*^9, 3.5633210639496555`*^9, 
   3.5633211547262144`*^9, 3.563321280275235*^9, 3.563321461531954*^9, 
   3.563321631541052*^9, 3.5633216681231165`*^9, {3.563321741989246*^9, 
   3.5633217707088966`*^9}, 3.5633218092721643`*^9, 3.563322721627389*^9, 
   3.563402463425604*^9, 3.5755783510310736`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"safeprs", "[", "n_", "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"n", "\[Equal]", "0"}], ",", "1", ",", 
    RowBox[{"Sqrt", "[", "n", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5631098478249273`*^9, 3.563109890787403*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"means", "[", 
   RowBox[{"l_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"votes", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "&"}], "/@", "l"}]}], ",", 
      RowBox[{"prs", "=", 
       RowBox[{
        RowBox[{"safeprs", "/@", 
         RowBox[{"preseats", "[", 
          RowBox[{"l", ",", "seats"}], "]"}]}], "//", "N"}]}], ",", 
      RowBox[{"pplus", "=", 
       RowBox[{
        RowBox[{"Sqrt", "/@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"1", "+", "#"}], "&"}], "/@", 
           RowBox[{"preseats", "[", 
            RowBox[{"l", ",", "seats"}], "]"}]}], ")"}]}], "//", "N"}]}]}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"seats", "\[Equal]", "0"}], ",", "votes", ",", 
      RowBox[{"votes", "/", 
       RowBox[{"(", 
        RowBox[{"prs", " ", "*", "pplus"}], ")"}]}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5626261450626726`*^9, 3.562626163689105*^9}, {
   3.5626261956535616`*^9, 3.5626262397236385`*^9}, {3.562626385006694*^9, 
   3.5626265223181353`*^9}, {3.562626553096989*^9, 3.562626883333969*^9}, {
   3.562626971552124*^9, 3.562626978884137*^9}, {3.5626270614862823`*^9, 
   3.562627104745158*^9}, 3.562627140531621*^9, {3.562627177441286*^9, 
   3.562627226565772*^9}, {3.562627324533944*^9, 3.5626273324119577`*^9}, {
   3.5626273731592293`*^9, 3.562627384344449*^9}, {3.5626277176702347`*^9, 
   3.5626278473376627`*^9}, {3.562627901750558*^9, 3.5626279266014013`*^9}, {
   3.5626279580354567`*^9, 3.562627992261917*^9}, {3.562628030435184*^9, 
   3.562628037236796*^9}, {3.5626285412580814`*^9, 3.562628562302518*^9}, {
   3.563109899195818*^9, 3.56310990066222*^9}, {3.5631104376619635`*^9, 
   3.563110470780822*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"means", "[", 
  RowBox[{"lst1", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.563110477457633*^9, 3.5631104819816413`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5567", ",", "7775", ",", "4435", ",", "7800", ",", "3000"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.5631104831516433`*^9, 3.5631104940716624`*^9}, 
   3.5631106783391857`*^9, 3.5631109894349327`*^9, 3.563111537042694*^9, 
   3.5631116874581585`*^9, 3.563111920538168*^9, 3.563197673028122*^9, 
   3.5632301959540677`*^9, 3.563230423543268*^9, 3.5633193911930037`*^9, 
   3.563321064277256*^9, 3.5633211548822145`*^9, 3.563321280384435*^9, 
   3.5633214616255536`*^9, 3.5633216316658525`*^9, 3.5633216682167163`*^9, {
   3.5633217420828466`*^9, 3.563321770818097*^9}, 3.5633218094125643`*^9, 
   3.5633227218145895`*^9, 3.563402463907631*^9, 3.575578351093474*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"means", "[", 
  RowBox[{"lst1", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.5626267764737816`*^9, 3.5626267837433944`*^9}, 
   3.5631097166910973`*^9, {3.5631099168862486`*^9, 3.5631099271822667`*^9}, {
   3.563110349100608*^9, 3.563110354966218*^9}, {3.5631104047147055`*^9, 
   3.563110409503914*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "5567.`", ",", "7775.`", ",", "4435.`", ",", "7800.`", ",", "3000.`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.5626267845389957`*^9, 3.562627156537249*^9, 3.562627232244182*^9, 
   3.5626273366551657`*^9, {3.562627388946457*^9, 3.5626274035012827`*^9}, 
   3.5626274914230375`*^9, 3.56262785156527*^9, {3.562627906414966*^9, 
   3.5626279301114078`*^9}, {3.5626279788458934`*^9, 3.5626279971759253`*^9}, 
   3.5626280427904053`*^9, 3.562628567294527*^9, 3.5628833916626253`*^9, 
   3.5629740903356423`*^9, 3.56297506266975*^9, 3.562975385902318*^9, 
   3.5629755894670753`*^9, 3.56297565483119*^9, {3.56301920193434*^9, 
   3.5630192280019855`*^9}, 3.5630193673822393`*^9, 3.563019724295266*^9, 
   3.5630331325561123`*^9, 3.5630341778240213`*^9, 3.563034325899482*^9, 
   3.5630344401064825`*^9, 3.5630345781823254`*^9, 3.5631069623432736`*^9, 
   3.563107227528139*^9, 3.5631078215805883`*^9, 3.56310799308729*^9, 
   3.5631080639738145`*^9, 3.5631083273022766`*^9, 3.563108488002939*^9, 
   3.5631090167646675`*^9, 3.563109263603901*^9, 3.5631097174710984`*^9, {
   3.563109910225037*^9, 3.5631099275878677`*^9}, {3.5631103498962092`*^9, 
   3.5631103560114202`*^9}, {3.5631104056507072`*^9, 
   3.5631104098939147`*^9}, {3.563110473947627*^9, 3.5631104941496625`*^9}, 
   3.563110678791587*^9, 3.5631109894817324`*^9, 3.5631115382438965`*^9, 
   3.563111687520559*^9, 3.563111920600568*^9, 3.563197673090522*^9, 
   3.5632301960164676`*^9, 3.563230423590068*^9, {3.563319384843793*^9, 
   3.5633193912710037`*^9}, 3.563321064386456*^9, 3.563321154960215*^9, 
   3.5633212804624357`*^9, 3.563321461703554*^9, 3.5633216317282524`*^9, 
   3.563321668294717*^9, {3.5633217421608467`*^9, 3.563321770880497*^9}, 
   3.5633218095061646`*^9, 3.5633227218769894`*^9, 3.5634024639916363`*^9, 
   3.575578351140274*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"means", "[", 
  RowBox[{"lst1", ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{3.5633193778081803`*^9, 3.563319413329443*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1607.0544742893235`", ",", "1738.5428525060865`", ",", 
   "1810.5811682072322`", ",", "1744.1330224498358`", ",", 
   "2121.3203435596424`"}], "}"}]], "Output",
 CellChangeTimes->{{3.563319379477383*^9, 3.5633194142498446`*^9}, 
   3.5633210650260572`*^9, 3.563321155038215*^9, 3.563321280540436*^9, 
   3.563321461765954*^9, 3.5633216318062525`*^9, 3.5633216683571167`*^9, {
   3.5633217422232466`*^9, 3.563321770942897*^9}, 3.563321809568565*^9, 
   3.5633227219393897`*^9, 3.5634024642796526`*^9, 3.575578351171474*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"epapport", "[", 
   RowBox[{"lst1", ",", "18"}], "]"}], "//", "TableForm"}]], "Input",
 CellChangeTimes->{{3.5629745033775673`*^9, 3.562974516840391*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "5567", "3", "1607.0544742893235`"},
    {"2", "7775", "5", "1419.5142948675557`"},
    {"3", "4435", "3", "1280.2742219279953`"},
    {"4", "7800", "5", "1424.0786495134319`"},
    {"5", "3000", "2", "1224.744871391589`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.5629745091183777`*^9, 3.562974517557993*^9}, 
   3.5629750627945504`*^9, 3.5629753860271177`*^9, 3.5629755895918756`*^9, 
   3.5629756549715905`*^9, {3.5630192021527405`*^9, 3.563019228142386*^9}, 
   3.563019368302641*^9, 3.5630197244356666`*^9, 3.5630331327745123`*^9, 
   3.563034178011222*^9, 3.563034326024282*^9, 3.5630344402468834`*^9, 
   3.563034578463126*^9, 3.5631069626552744`*^9, 3.5631072276685395`*^9, 
   3.5631078220953894`*^9, 3.56310799324329*^9, 3.5631080640830145`*^9, 
   3.5631083274270773`*^9, 3.5631084881589394`*^9, 3.563109017014268*^9, 
   3.5631092641655025`*^9, 3.563110494305663*^9, 3.563110679025587*^9, 
   3.5631109897313333`*^9, 3.563111538415497*^9, 3.563111687629759*^9, 
   3.563111920662968*^9, 3.563197673168522*^9, 3.5632301961256676`*^9, 
   3.563230423652468*^9, 3.5633193914582043`*^9, 3.5633210651196575`*^9, 
   3.563321155116215*^9, 3.5633212806028357`*^9, 3.563321461843954*^9, 
   3.563321631868653*^9, 3.563321668435117*^9, {3.5633217423012466`*^9, 
   3.563321771020897*^9}, 3.5633218096309648`*^9, 3.56332272201739*^9, 
   3.563402464691676*^9, 3.5755783512338743`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"actualrep", "[", 
   RowBox[{"list_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"eap", "=", 
      RowBox[{"epapport", "[", 
       RowBox[{"list", ",", "seats"}], "]"}]}], "}"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"eap", "[", 
           RowBox[{"[", "#", "]"}], "]"}], "[", 
          RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], ",", "0", ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"eap", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}], "/", 
           RowBox[{
            RowBox[{"eap", "[", 
             RowBox[{"[", "#", "]"}], "]"}], "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], "//", "N"}], ")"}]}], "]"}], 
      "&"}], "/@", 
     RowBox[{
      RowBox[{"Transpose", "[", "eap", "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5630195136792965`*^9, 3.563019529263724*^9}, {
   3.5630195745506034`*^9, 3.5630195972174435`*^9}, {3.5630196532683415`*^9, 
   3.563019694343214*^9}, {3.5630198342130594`*^9, 3.563019847613483*^9}, {
   3.5630199059575853`*^9, 3.5630199367364397`*^9}, {3.563020083766698*^9, 
   3.5630201213003635`*^9}, {3.563020173544855*^9, 3.5630201835444727`*^9}, {
   3.563021038129574*^9, 3.563021072340434*^9}, {3.56302113261894*^9, 
   3.563021140746554*^9}, {3.5630212605235643`*^9, 3.563021448269894*^9}, {
   3.563108824821931*^9, 3.563108900528864*^9}, {3.5631089402621336`*^9, 
   3.5631089829594083`*^9}, 3.5633216238970385`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"actualrep", "[", 
  RowBox[{"lst1", ",", "9"}], "]"}]], "Input",
 CellChangeTimes->{{3.5631089090464783`*^9, 3.5631089165500917`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "2783.5`", ",", "2591.6666666666665`", ",", "4435.`", ",", "2600.`", ",", 
   "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.563108917657694*^9, {3.5631089739893923`*^9, 3.563109018792671*^9}, 
   3.563109266895507*^9, 3.5631104947892637`*^9, 3.563110680117589*^9, 
   3.563110991416136*^9, 3.5631115388834977`*^9, 3.56311168806656*^9, 
   3.563111920772168*^9, 3.563197673262122*^9, 3.563230196219268*^9, 
   3.563230423761668*^9, 3.5633193915674047`*^9, 3.5633210652600574`*^9, 
   3.5633211552098155`*^9, 3.563321280790036*^9, 3.563321461921954*^9, 
   3.563321631993453*^9, 3.5633216685131173`*^9, {3.563321742394847*^9, 
   3.563321771114497*^9}, 3.563321809740165*^9, 3.56332272214219*^9, 
   3.563402464779681*^9, 3.575578351280674*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"actualrep", "[", 
  RowBox[{"lst1", ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.5630197009732256`*^9, 3.5630197066048355`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1855.6666666666667`", ",", "1555.`", ",", "1478.3333333333333`", ",", 
   "1560.`", ",", "1500.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.563021416586239*^9, 3.5630214539951043`*^9}, 
   3.5630331335077143`*^9, 3.5630341798052254`*^9, 3.5630343268822837`*^9, 
   3.5630344410112844`*^9, 3.5630345793055277`*^9, 3.563106969129286*^9, 
   3.563107228557741*^9, 3.5631078242949934`*^9, 3.5631079959732947`*^9, 
   3.563108064785016*^9, 3.5631083281602783`*^9, 3.563108488876541*^9, 
   3.563108905520872*^9, {3.563108999105437*^9, 3.5631090189486713`*^9}, 
   3.563109266957907*^9, 3.563110494867264*^9, 3.5631106802267895`*^9, 
   3.563110991462936*^9, 3.5631115389458976`*^9, 3.5631116881289597`*^9, 
   3.5631119208345685`*^9, 3.563197673324522*^9, 3.5632301962816677`*^9, 
   3.563230423824068*^9, 3.5633193916298046`*^9, 3.5633210653536577`*^9, 
   3.563321155272216*^9, 3.5633212808680363`*^9, 3.5633214620311546`*^9, 
   3.563321632071453*^9, 3.563321668575517*^9, {3.563321742457247*^9, 
   3.563321771176897*^9}, 3.563321809802565*^9, 3.56332272220459*^9, 
   3.563402464828684*^9, 3.575578351327474*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"actualrep", "[", 
   RowBox[{"lst1", ",", "18"}], "]"}], "/", 
  RowBox[{"squota", "[", 
   RowBox[{"lst1", ",", "18"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.563320218080057*^9, 3.5633202438201017`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.16884207579522`", ",", "0.9794590054939288`", ",", "0.9311684221576793`",
    ",", "0.9826083913636842`", ",", "0.9448157609266195`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5633202463785067`*^9, 3.563321065431658*^9, 3.5633211553346157`*^9, 
   3.5633212809928365`*^9, 3.5633214621091547`*^9, 3.5633216321650534`*^9, 
   3.5633216686535172`*^9, {3.5633217425196466`*^9, 3.563321771239298*^9}, 
   3.5633218098649654`*^9, 3.56332272228259*^9, 3.5634024649656916`*^9, 
   3.575578351358674*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"compratio", "[", 
   RowBox[{"list_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"eap", "=", 
       RowBox[{"epapport", "[", 
        RowBox[{"list", ",", "seats"}], "]"}]}], ",", 
      RowBox[{"s", "=", 
       RowBox[{"squota", "[", 
        RowBox[{"list", ",", "seats"}], "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"actualrep", "[", 
      RowBox[{"list", ",", "seats"}], "]"}], "/", "s"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5633192183603*^9, 3.563319258436771*^9}, {
   3.5633201016882524`*^9, 3.5633201968172197`*^9}, {3.56332025979453*^9, 
   3.5633202598569303`*^9}, 3.563321548361706*^9, 3.5633216468134785`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compratio", "[", 
  RowBox[{"lst1", ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.5633201989076233`*^9, 3.5633202041180325`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1.16884207579522`", ",", "0.9794590054939288`", ",", "0.9311684221576793`",
    ",", "0.9826083913636842`", ",", "0.9448157609266195`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.5633202052100344`*^9, 3.563320264349738*^9, 3.5633210659776587`*^9, 
   3.563321155412616*^9, 3.5633212811956367`*^9, 3.563321462187155*^9, 
   3.5633215521213126`*^9, {3.5633216323834534`*^9, 3.5633216687627172`*^9}, {
   3.563321742613247*^9, 3.5633217713328977`*^9}, 3.5633218100053654`*^9, 
   3.5633227224073906`*^9, 3.5634024657037334`*^9, 3.5755783514054747`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"compratio", "[", 
  RowBox[{"lst1", ",", "9"}], "]"}]], "Input",
 CellChangeTimes->{3.5633215405772924`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.876631556846415`", ",", "0.8162158379116072`", ",", "1.396752633236519`",
    ",", "0.8188403261364035`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.563321541341694*^9, 3.5633215550853176`*^9}, {
   3.5633216324770536`*^9, 3.5633216688563175`*^9}, {3.563321742691247*^9, 
   3.563321771395298*^9}, 3.5633218100677657`*^9, 3.5633227224697905`*^9, 
   3.563402465828741*^9, 3.5755783514522743`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Presentation", "Subsection",
 CellChangeTimes->{{3.5632303127674737`*^9, 3.563230319849886*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"preshow", "[", 
   RowBox[{"list_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"q", "=", 
       RowBox[{"uquota", "[", 
        RowBox[{"list", ",", "seats"}], "]"}]}], ",", 
      RowBox[{"p", "=", 
       RowBox[{"preseats", "[", 
        RowBox[{"list", ",", "seats"}], "]"}]}], ",", 
      RowBox[{"m", "=", 
       RowBox[{"means", "[", 
        RowBox[{"list", ",", "seats"}], "]"}]}], ",", " ", 
      RowBox[{"t", "=", 
       RowBox[{"eptotvotes", "[", 
        RowBox[{"list", ",", "seats"}], "]"}]}], ",", 
      RowBox[{"a", "=", 
       RowBox[{"actualrep", "[", 
        RowBox[{"list", ",", "seats"}], "]"}]}], ",", 
      RowBox[{"c", "=", 
       RowBox[{"compratio", "[", 
        RowBox[{"list", ",", "seats"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "2", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "3", "]"}], "]"}], ",", 
          RowBox[{"#", "[", 
           RowBox[{"[", "4", "]"}], "]"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"q", "\[Equal]", "\"\<no quota\>\""}], ",", 
            "\"\<no quota\>\"", ",", " ", 
            RowBox[{
             RowBox[{"#", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "/", "q"}]}], "]"}]}], "}"}], 
        "&"}], "/@", 
       RowBox[{"epapport", "[", 
        RowBox[{"list", ",", "seats"}], "]"}]}], ",", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"p", ",", "m", ",", "a", ",", "c"}], "}"}], "]"}], ",", "2"}],
      "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.563036257469675*^9, 3.5630363231301904`*^9}, {
   3.5631094584014435`*^9, 3.5631095317995725`*^9}, {3.5633202945981913`*^9, 
   3.563320317436631*^9}, {3.5633211308737726`*^9, 3.5633211351013803`*^9}, 
   3.5633213093692865`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"preshow", "[", 
  RowBox[{"lst1", ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.563036332053406*^9, 3.56303633999382*^9}, {
  3.5631093788725038`*^9, 3.563109389340122*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "5567", ",", "3", ",", "1607.0544742893235`", ",", 
     "3.50652622738566`", ",", "3", ",", "1607.0544742893235`", ",", 
     "1855.6666666666667`", ",", "1.16884207579522`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "7775", ",", "5", ",", "1419.5142948675557`", ",", 
     "4.897295027469644`", ",", "4", ",", "1738.5428525060865`", ",", 
     "1555.`", ",", "0.9794590054939288`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3", ",", "4435", ",", "3", ",", "1280.2742219279953`", ",", 
     "2.793505266473038`", ",", "2", ",", "1810.5811682072322`", ",", 
     "1478.3333333333333`", ",", "0.9311684221576793`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "7800", ",", "5", ",", "1424.0786495134319`", ",", 
     "4.913041956818421`", ",", "4", ",", "1744.1330224498358`", ",", 
     "1560.`", ",", "0.9826083913636842`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5", ",", "3000", ",", "2", ",", "1224.744871391589`", ",", 
     "1.889631521853239`", ",", "1", ",", "2121.3203435596424`", ",", 
     "1500.`", ",", "0.9448157609266195`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.563109384550914*^9, 3.563109390494524*^9}, 
   3.563109535683979*^9, 3.5631104968328676`*^9, 3.5631106818491926`*^9, 
   3.563110993054139*^9, 3.5631115400690994`*^9, 3.563111688737361*^9, 
   3.5631119216925697`*^9, 3.5631976740109234`*^9, 3.5632301968588696`*^9, 
   3.56323042440127*^9, 3.563319392472206*^9, 3.563321069409665*^9, 
   3.5633211562706175`*^9, 3.563321283613641*^9, 3.5633213149852962`*^9, 
   3.563321462389955*^9, 3.563321632617454*^9, 3.563321669027918*^9, {
   3.5633217428004475`*^9, 3.5633217715200977`*^9}, 3.563321810208166*^9, 
   3.5633227226257906`*^9, 3.563402466977807*^9, 3.5755783516082745`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"preshow", "[", 
  RowBox[{"lst1", ",", "9"}], "]"}]], "Input",
 CellChangeTimes->{{3.563109661701*^9, 3.5631096674262104`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "5567", ",", "2", ",", "2272.7182330123255`", ",", 
     "1.75326311369283`", ",", "1", ",", "3936.46345086551`", ",", "2783.5`", 
     ",", "0.876631556846415`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "7775", ",", "3", ",", "2244.4491714746705`", ",", 
     "2.448647513734822`", ",", "2", ",", "3174.1304583565347`", ",", 
     "2591.6666666666665`", ",", "0.8162158379116072`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3", ",", "4435", ",", "1", ",", "3136.018574562338`", ",", 
     "1.396752633236519`", ",", "1", ",", "3136.018574562338`", ",", "4435.`",
      ",", "1.396752633236519`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "7800", ",", "3", ",", "2251.6660498395404`", ",", 
     "2.4565209784092104`", ",", "2", ",", "3184.336665618131`", ",", 
     "2600.`", ",", "0.8188403261364035`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5", ",", "3000", ",", "0", ",", "3000", ",", "0.9448157609266195`", ",", 
     "0", ",", "3000.`", ",", "0", ",", "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.563109662527802*^9, 3.5631096697194147`*^9}, 
   3.5631104968952675`*^9, 3.5631106821299925`*^9, 3.563110993100939*^9, 
   3.5631115401783*^9, 3.5631116887841606`*^9, 3.56311192178617*^9, 
   3.5631976740733232`*^9, 3.5632301969212694`*^9, 3.56323042446367*^9, 
   3.5633193925346065`*^9, 3.5633210697372656`*^9, 3.5633211567230177`*^9, 
   3.563321283676041*^9, {3.563321319462504*^9, 3.56332132295691*^9}, 
   3.563321462561555*^9, 3.563321632711054*^9, 3.5633216691527185`*^9, {
   3.5633217428940477`*^9, 3.563321771598098*^9}, 3.563321810286166*^9, 
   3.563322722812991*^9, 3.563402467469835*^9, 3.5755783517018747`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"arrangesimple", "[", 
   RowBox[{"list_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "4", "]"}], "]"}]}], "}"}], "&"}], "/@", 
   RowBox[{"preshow", "[", 
    RowBox[{"list", ",", "seats"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5631110633478622`*^9, 3.56311116421764*^9}, {
  3.563111196868497*^9, 3.563111232046559*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"arrangesimple", "[", 
  RowBox[{"lst1", ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.563111167883646*^9, 3.563111180472868*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "5567", ",", "3", ",", "1607.0544742893235`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "7775", ",", "5", ",", "1419.5142948675557`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"3", ",", "4435", ",", "3", ",", "1280.2742219279953`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "7800", ",", "5", ",", "1424.0786495134319`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "3000", ",", "2", ",", "1224.744871391589`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.563111235837365*^9, 3.5631115406619005`*^9, 3.563111688877761*^9, 
   3.5631119219577703`*^9, 3.5631976741669235`*^9, 3.5632301970148697`*^9, 
   3.56323042458847*^9, 3.5633193926282063`*^9, 3.5633210706108665`*^9, 
   3.5633211569258184`*^9, 3.5633212838320417`*^9, 3.5633214627331553`*^9, 
   3.5633216328670545`*^9, 3.5633216692775183`*^9, {3.563321743050048*^9, 
   3.563321771769698*^9}, 3.563321810426566*^9, 3.5633227229689913`*^9, 
   3.563402467589842*^9, 3.575578351873475*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"arrangecomparison", "[", 
   RowBox[{"list_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"#", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "3", "]"}], "]"}], ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "5", "]"}], "]"}], ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "8", "]"}], "]"}], ",", 
      RowBox[{"#", "[", 
       RowBox[{"[", "9", "]"}], "]"}]}], "}"}], "&"}], "/@", 
   RowBox[{"preshow", "[", 
    RowBox[{"list", ",", "seats"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5630363466550317`*^9, 3.5630364495372124`*^9}, {
   3.563036512467723*^9, 3.5630365480669856`*^9}, {3.5630369038800097`*^9, 
   3.563037052572671*^9}, 3.5630371761092873`*^9, {3.5631083062110395`*^9, 
   3.5631083076930428`*^9}, {3.5633217323328295`*^9, 3.563321735109634*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"arrangecomparison", "[", 
  RowBox[{"lst1", ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.5630365538857956`*^9, 3.5630365634330125`*^9}, {
  3.563108310360647*^9, 3.5631083116866493`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "5567", ",", "3", ",", "3.50652622738566`", ",", 
     "1855.6666666666667`", ",", "1.16884207579522`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "7775", ",", "5", ",", "4.897295027469644`", ",", "1555.`", ",",
      "0.9794590054939288`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3", ",", "4435", ",", "3", ",", "2.793505266473038`", ",", 
     "1478.3333333333333`", ",", "0.9311684221576793`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "7800", ",", "5", ",", "4.913041956818421`", ",", "1560.`", ",",
      "0.9826083913636842`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5", ",", "3000", ",", "2", ",", "1.889631521853239`", ",", "1500.`", ",",
      "0.9448157609266195`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.563036565258216*^9, {3.563036960586109*^9, 3.5630369994857774`*^9}, 
   3.5630370749275103`*^9, {3.5630371804460955`*^9, 3.5630371854381037`*^9}, 
   3.5631069699716873`*^9, 3.5631072293533425`*^9, 3.5631078271653986`*^9, 
   3.5631079978452983`*^9, 3.563108065440217*^9, 3.5631083288310795`*^9, 
   3.5631084907173443`*^9, 3.563109021351076*^9, 3.5631092690015106`*^9, 
   3.5631104970200677`*^9, 3.5631106829723945`*^9, 3.5631109932101393`*^9, 
   3.563111540989501*^9, 3.5631116889869614`*^9, 3.563111922160571*^9, 
   3.563197674260524*^9, 3.56323019717087*^9, 3.56323042469767*^9, 
   3.5633193927218065`*^9, 3.5633210709852676`*^9, 3.56332115754982*^9, 
   3.563321284159642*^9, 3.5633214628423557`*^9, 3.5633216329918547`*^9, 
   3.563321669402319*^9, {3.5633217432372484`*^9, 3.5633217719256988`*^9}, 
   3.5633218105357666`*^9, 3.5633227231093917`*^9, 3.5634024677218494`*^9, 
   3.5755783524818764`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"arrangecomparison", "[", 
  RowBox[{"lst1", ",", "9"}], "]"}]], "Input",
 CellChangeTimes->{3.56332175557687*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "5567", ",", "2", ",", "1.75326311369283`", ",", "2783.5`", ",",
      "0.876631556846415`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "2", ",", "7775", ",", "3", ",", "2.448647513734822`", ",", 
     "2591.6666666666665`", ",", "0.8162158379116072`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "3", ",", "4435", ",", "1", ",", "1.396752633236519`", ",", "4435.`", ",",
      "1.396752633236519`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "4", ",", "7800", ",", "3", ",", "2.4565209784092104`", ",", "2600.`", 
     ",", "0.8188403261364035`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "5", ",", "3000", ",", "0", ",", "0.9448157609266195`", ",", "0", ",", 
     "0.`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.56332176113048*^9, 3.5633217720348988`*^9}, 
   3.5633218106137667`*^9, 3.5633227232029915`*^9, 3.563402467791853*^9, 
   3.5755783525286765`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TableForm", "[", "%", "]"}]], "Input",
 CellChangeTimes->{{3.5630360240152655`*^9, 3.5630360294284744`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {"1", "5567", "2", "1.75326311369283`", "2783.5`", "0.876631556846415`"},
    {"2", "7775", "3", "2.448647513734822`", "2591.6666666666665`", 
     "0.8162158379116072`"},
    {"3", "4435", "1", "1.396752633236519`", "4435.`", "1.396752633236519`"},
    {"4", "7800", "3", "2.4565209784092104`", "2600.`", "0.8188403261364035`"},
    {"5", "3000", "0", "0.9448157609266195`", "0", "0.`"}
   },
   GridBoxAlignment->{
    "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
     "RowsIndexed" -> {}},
   GridBoxSpacings->{"Columns" -> {
       Offset[0.27999999999999997`], {
        Offset[2.0999999999999996`]}, 
       Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
       Offset[0.2], {
        Offset[0.4]}, 
       Offset[0.2]}, "RowsIndexed" -> {}}],
  Function[BoxForm`e$, 
   TableForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.5630360301460757`*^9, 3.56303657369783*^9, 3.563037094770745*^9, 
   3.5630371910073137`*^9, 3.5631069700496874`*^9, 3.563107229415743*^9, 
   3.563107827336999*^9, 3.5631079978920984`*^9, 3.563108065502617*^9, 
   3.5631083288934793`*^9, 3.563108490764144*^9, 3.563109021522676*^9, 
   3.563109269032711*^9, 3.563110497082468*^9, 3.5631106830191946`*^9, 
   3.563110993241339*^9, 3.5631115410519013`*^9, 3.563111689049361*^9, 
   3.563111922222971*^9, 3.5631976743229237`*^9, 3.5632301972332697`*^9, 
   3.56323042476007*^9, 3.563319392768607*^9, 3.563321071110068*^9, 
   3.5633211576278195`*^9, 3.563321284206442*^9, 3.563321462904756*^9, 
   3.563321633085455*^9, 3.563321669464719*^9, {3.5633217433152485`*^9, 
   3.563321772112899*^9}, 3.563321810660567*^9, 3.563322723280992*^9, 
   3.5634024678438563`*^9, 3.5755783525754766`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"bfformatlist", "[", "list_", "]"}], ":=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"#", ",", "Bold", ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], "&"}], 
    ",", "list", ",", 
    RowBox[{"{", "2", "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"bfformathead", "[", "l_", "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"Style", "[", 
     RowBox[{"#", ",", "Bold", ",", 
      RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}], "&"}], "/@",
    "l"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"myf", "[", "string_", "]"}], ":=", 
  RowBox[{"Style", "[", 
   RowBox[{"string", ",", "Bold", ",", 
    RowBox[{"FontFamily", "\[Rule]", "\"\<Arial\>\""}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"showsimple", "[", 
   RowBox[{"list_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"Column", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\"\<Total votes = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"eptotvotes", "[", 
         RowBox[{"list", ",", "seats"}], "]"}], "]"}], "<>", "\"\<  \>\"", 
       "<>", "\"\<Seats = \>\"", "<>", 
       RowBox[{"ToString", "[", "seats", "]"}], "<>", "\"\<  \>\"", "<>", 
       "\"\<Quota = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"squota", "[", 
         RowBox[{"list", ",", "seats"}], "]"}], "]"}]}], "//", "myf"}], ",", 
     RowBox[{"TableForm", "[", 
      RowBox[{
       RowBox[{"bfformatlist", "[", 
        RowBox[{"arrangesimple", "[", 
         RowBox[{"list", ",", "seats"}], "]"}], "]"}], ",", 
       RowBox[{"TableHeadings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"None", ",", 
          RowBox[{"bfformathead", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Name\>\"", ",", "\"\<Votes\>\"", ",", "\"\<SeatsAsgd\>\"", 
             ",", "\"\<Weight\>\""}], "}"}], "]"}]}], "}"}]}]}], "]"}]}], 
    "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5631112763038363`*^9, 3.5631113805276194`*^9}, {
   3.5631114119304743`*^9, 3.5631114272185016`*^9}, {3.563211987237348*^9, 
   3.5632119978453665`*^9}, 3.563212041213443*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"showsimple", "[", 
  RowBox[{"lst1", ",", "18"}], "]"}]], "Input",
 CellChangeTimes->{{3.5631113916036386`*^9, 3.5631114019932575`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"Total votes = 28577  Seats = 18  Quota = 1587.61\"\>",
      StripOnInput->False,
      FontFamily->"Arial",
      FontWeight->Bold]},
    {
     TagBox[
      TagBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"Name\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"Votes\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"SeatsAsgd\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"Weight\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm]},
         {
          StyleBox["1",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["5567",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["1607.0544742893235`",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["2",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7775",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["5",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["1419.5142948675557`",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["3",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["4435",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["1280.2742219279953`",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["4",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7800",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["5",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["1424.0786495134319`",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["5",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3000",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["2",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["1224.744871391589`",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxDividers->{
         "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[2.0999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       {None, OutputFormsDump`HeadedColumns}],
      Function[BoxForm`e$, 
       TableForm[BoxForm`e$, TableHeadings -> {None, {
           Style["Name", Bold, FontFamily -> "Arial"], 
           Style["Votes", Bold, FontFamily -> "Arial"], 
           Style["SeatsAsgd", Bold, FontFamily -> "Arial"], 
           Style["Weight", Bold, FontFamily -> "Arial"]}}]]]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.5631114027888584`*^9, 3.56311143213251*^9}, 
   3.563111541270302*^9, 3.5631116892677617`*^9, 3.5631119230029726`*^9, 
   3.5631976745413246`*^9, 3.5632120117449913`*^9, 3.56323019743607*^9, 
   3.5632304249628706`*^9, 3.563319392940207*^9, 3.563321073996073*^9, 
   3.56332115781502*^9, 3.5633212845184426`*^9, 3.5633214631231565`*^9, 
   3.5633216333350554`*^9, 3.5633216696519194`*^9, {3.5633217435336485`*^9, 
   3.5633217723156996`*^9}, 3.563321810910167*^9, 3.5633227234993925`*^9, 
   3.563402468017866*^9, 3.5755783527158766`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"showsimple", "[", 
  RowBox[{"lst1", ",", "5"}], "]"}]], "Input",
 CellChangeTimes->{{3.563111448450139*^9, 3.563111463972166*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"Total votes = 28577  Seats = 5  Quota = 5715.4\"\>",
      StripOnInput->False,
      FontFamily->"Arial",
      FontWeight->Bold]},
    {
     TagBox[
      TagBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"Name\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"Votes\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"SeatsAsgd\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"Weight\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm]},
         {
          StyleBox["1",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["5567",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["1",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3936.46345086551`",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["2",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7775",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["2",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3174.130458356535`",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["3",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["4435",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["4435",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["4",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7800",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["2",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3184.336665618131`",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["5",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3000",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3000",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxDividers->{
         "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[2.0999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       {None, OutputFormsDump`HeadedColumns}],
      Function[BoxForm`e$, 
       TableForm[BoxForm`e$, TableHeadings -> {None, {
           Style["Name", Bold, FontFamily -> "Arial"], 
           Style["Votes", Bold, FontFamily -> "Arial"], 
           Style["SeatsAsgd", Bold, FontFamily -> "Arial"], 
           Style["Weight", Bold, FontFamily -> "Arial"]}}]]]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{{3.563111456218952*^9, 3.5631114645337667`*^9}, 
   3.5631115417227025`*^9, 3.563111689330162*^9, 3.5631119232213726`*^9, 
   3.5631976746349244`*^9, 3.5632120179070015`*^9, 3.5632120548010664`*^9, 
   3.5632301975140705`*^9, 3.5632304250252705`*^9, 3.5633193930026073`*^9, 
   3.5633210742612734`*^9, 3.5633211581738205`*^9, 3.563321284565243*^9, 
   3.5633214632011566`*^9, 3.5633216334286556`*^9, 3.5633216697299194`*^9, {
   3.563321743611649*^9, 3.5633217723936996`*^9}, 3.563321811003767*^9, 
   3.5633227235929923`*^9, 3.563402468106871*^9, 3.5755783527782764`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"showsimple", "[", 
  RowBox[{"lst1", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.563111470040577*^9, 3.5631114758749866`*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"Total votes = 28577  Seats = 0  Quota = no quota\"\>",
      StripOnInput->False,
      FontFamily->"Arial",
      FontWeight->Bold]},
    {
     TagBox[
      TagBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"Name\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"Votes\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"SeatsAsgd\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"Weight\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm]},
         {
          StyleBox["1",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["5567",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["5567",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["2",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7775",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7775",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["3",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["4435",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["4435",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["4",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7800",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7800",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["5",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3000",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3000",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxDividers->{
         "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[2.0999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       {None, OutputFormsDump`HeadedColumns}],
      Function[BoxForm`e$, 
       TableForm[BoxForm`e$, TableHeadings -> {None, {
           Style["Name", Bold, FontFamily -> "Arial"], 
           Style["Votes", Bold, FontFamily -> "Arial"], 
           Style["SeatsAsgd", Bold, FontFamily -> "Arial"], 
           Style["Weight", Bold, FontFamily -> "Arial"]}}]]]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.5632120482802553`*^9, 3.5632301975920706`*^9, 3.563230425087671*^9, 
   3.563319393065007*^9, 3.563321079362482*^9, 3.5633211582986207`*^9, 
   3.563321285236044*^9, 3.5633214632635565`*^9, 3.563321633522256*^9, 
   3.5633216697923193`*^9, {3.563321743689649*^9, 3.5633217724560995`*^9}, 
   3.5633218110661674`*^9, 3.563322723670993*^9, 3.563402468169875*^9, 
   3.575578352825077*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["This is PartySimple.cdf", "Subsection",
 CellChangeTimes->{{3.5632302741106057`*^9, 3.563230285826226*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DynamicModule", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "list", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"list", "=", 
        RowBox[{"epsetup", "[", 
         RowBox[{"{", 
          RowBox[{"n1", ",", "n2", ",", "n3", ",", "n4", ",", "n5"}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"showsimple", "[", 
        RowBox[{"list", ",", "seats"}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1", ",", "8234"}], "}"}], ",", "0", ",", "10000", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n2", ",", "7001"}], "}"}], ",", "0", ",", "10000", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n3", ",", "5503"}], "}"}], ",", "0", ",", "10000", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n4", ",", "4356"}], "}"}], ",", "0", ",", "10000", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n5", ",", "2390"}], "}"}], ",", "0", ",", "10000", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"seats", ",", "10"}], "}"}], ",", "0", ",", "100", ",", "1", 
     ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Paneled", "\[Rule]", "False"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.5631080302777553`*^9, 3.563108032461759*^9}, {
   3.5631081404139485`*^9, 3.5631081427227526`*^9}, {3.563111515187056*^9, 
   3.563111515951457*^9}, 3.563111660485711*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n1$$ = 8234, $CellContext`n2$$ = 
    7001, $CellContext`n3$$ = 5503, $CellContext`n4$$ = 
    4356, $CellContext`n5$$ = 2390, $CellContext`seats$$ = 10, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`n1$$], 8234}, 0, 10000, 1}, {{
       Hold[$CellContext`n2$$], 7001}, 0, 10000, 1}, {{
       Hold[$CellContext`n3$$], 5503}, 0, 10000, 1}, {{
       Hold[$CellContext`n4$$], 4356}, 0, 10000, 1}, {{
       Hold[$CellContext`n5$$], 2390}, 0, 10000, 1}, {{
       Hold[$CellContext`seats$$], 10}, 0, 100, 1}}, Typeset`size$$ = {
    297., {55.5, 60.5}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`n1$9309$$ = 
    0, $CellContext`n2$9310$$ = 0, $CellContext`n3$9311$$ = 
    0, $CellContext`n4$9312$$ = 0, $CellContext`n5$9313$$ = 
    0, $CellContext`seats$9314$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`n1$$ = 8234, $CellContext`n2$$ = 
        7001, $CellContext`n3$$ = 5503, $CellContext`n4$$ = 
        4356, $CellContext`n5$$ = 2390, $CellContext`seats$$ = 10}, 
      "ControllerVariables" :> {
        Hold[$CellContext`n1$$, $CellContext`n1$9309$$, 0], 
        Hold[$CellContext`n2$$, $CellContext`n2$9310$$, 0], 
        Hold[$CellContext`n3$$, $CellContext`n3$9311$$, 0], 
        Hold[$CellContext`n4$$, $CellContext`n4$9312$$, 0], 
        Hold[$CellContext`n5$$, $CellContext`n5$9313$$, 0], 
        Hold[$CellContext`seats$$, $CellContext`seats$9314$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> DynamicModule[{$CellContext`list}, 
        Dynamic[$CellContext`list = $CellContext`epsetup[{$CellContext`n1$$, \
$CellContext`n2$$, $CellContext`n3$$, $CellContext`n4$$, $CellContext`n5$$}]; \
$CellContext`showsimple[$CellContext`list, $CellContext`seats$$]]], 
      "Specifications" :> {{{$CellContext`n1$$, 8234}, 0, 10000, 
         1}, {{$CellContext`n2$$, 7001}, 0, 10000, 
         1}, {{$CellContext`n3$$, 5503}, 0, 10000, 
         1}, {{$CellContext`n4$$, 4356}, 0, 10000, 
         1}, {{$CellContext`n5$$, 2390}, 0, 10000, 
         1}, {{$CellContext`seats$$, 10}, 0, 100, 1, Appearance -> "Open"}}, 
      "Options" :> {Paneled -> False}, "DefaultOptions" :> {}],
     ImageSizeCache->{317., {175., 180.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`epsetup[
         Pattern[$CellContext`l, 
          Blank[]]] := Transpose[{
          Range[
          5], $CellContext`l, $CellContext`zlist, $CellContext`l}], \
$CellContext`zlist := {0, 0, 0, 0, 0}, $CellContext`showsimple[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := Column[{
          $CellContext`myf[
           StringJoin["Total votes = ", 
            ToString[
             $CellContext`eptotvotes[$CellContext`list, $CellContext`seats]], 
            "  ", "Seats = ", 
            ToString[$CellContext`seats], "  ", "Quota = ", 
            ToString[
             $CellContext`squota[$CellContext`list, $CellContext`seats]]]], 
          TableForm[
           $CellContext`bfformatlist[
            $CellContext`arrangesimple[$CellContext`list, \
$CellContext`seats]], TableHeadings -> {None, 
             $CellContext`bfformathead[{
              "Name", "Votes", "SeatsAsgd", "Weight"}]}]}], $CellContext`myf[
         Pattern[$CellContext`string, 
          Blank[]]] := 
       Style[$CellContext`string, Bold, FontFamily -> 
         "Arial"], $CellContext`eptotvotes[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := Apply[Plus, 
         Part[
          $CellContext`epapport[$CellContext`list, $CellContext`seats], All, 
          2]], $CellContext`epapport[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       NestWhile[$CellContext`update, $CellContext`l, 1, $CellContext`seats + 
         1], $CellContext`update[
         Pattern[$CellContext`l, 
          Blank[]]] := 
       Module[{$CellContext`li = ReplacePart[$CellContext`l, Part[
              $CellContext`pickit[$CellContext`l], 
              1] -> $CellContext`pickit[$CellContext`l]]}, 
         Return[$CellContext`li]], $CellContext`pickit[
         Pattern[$CellContext`l, 
          Blank[]]] := $CellContext`epchangeone[
         $CellContext`singleout[$CellContext`l]], $CellContext`epchangeone[
         Pattern[$CellContext`item, 
          Blank[]]] := {
         Part[$CellContext`item, 1], 
         Part[$CellContext`item, 2], Part[$CellContext`item, 3] + 1, 
         $CellContext`epwt[
          Part[$CellContext`item, 2], Part[$CellContext`item, 3] + 
          1]}, $CellContext`epwt[
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`n, 
          Blank[]]] := If[$CellContext`n == 0, $CellContext`p, 
         N[$CellContext`p/
          Sqrt[$CellContext`n ($CellContext`n + 1)]]], $CellContext`singleout[
         Pattern[$CellContext`l, 
          Blank[]]] := Part[
         Select[$CellContext`l, Part[#, 4] == Max[
            Part[$CellContext`l, All, 4]]& , 1], 1], $CellContext`squota[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := If[$CellContext`seats == 0, "no quota", 
         N[$CellContext`totvotes[$CellContext`l]/$CellContext`seats]], \
$CellContext`totvotes[
         Pattern[$CellContext`l, 
          Blank[]]] := Apply[Plus, 
         Part[$CellContext`l, All, 2]], $CellContext`bfformatlist[
         Pattern[$CellContext`list, 
          Blank[]]] := 
       Map[Style[#, Bold, FontFamily -> "Arial"]& , $CellContext`list, {
         2}], $CellContext`arrangesimple[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := Map[{
          Part[#, 1], 
          Part[#, 2], 
          Part[#, 3], 
          Part[#, 4]}& , 
         $CellContext`preshow[$CellContext`list, $CellContext`seats]], \
$CellContext`preshow[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       Module[{$CellContext`q = $CellContext`uquota[$CellContext`list, \
$CellContext`seats], $CellContext`p = \
$CellContext`preseats[$CellContext`list, $CellContext`seats], $CellContext`m = \
$CellContext`means[$CellContext`list, $CellContext`seats], $CellContext`t = \
$CellContext`eptotvotes[$CellContext`list, $CellContext`seats], \
$CellContext`a = $CellContext`actualrep[$CellContext`list, \
$CellContext`seats], $CellContext`c = \
$CellContext`compratio[$CellContext`list, $CellContext`seats]}, 
         Join[
          Map[{
            Part[#, 1], 
            Part[#, 2], 
            Part[#, 3], 
            Part[#, 4], 
            
            If[$CellContext`q == "no quota", "no quota", 
             Part[#, 2]/$CellContext`q]}& , 
           $CellContext`epapport[$CellContext`list, $CellContext`seats]], 
          
          Transpose[{$CellContext`p, $CellContext`m, $CellContext`a, \
$CellContext`c}], 2]], $CellContext`uquota[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := If[$CellContext`seats == 0, 1, 
         N[$CellContext`totvotes[$CellContext`l]/$CellContext`seats]], \
$CellContext`preseats[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := Map[Floor, 
         $CellContext`ideal[$CellContext`l, $CellContext`seats]], \
$CellContext`ideal[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       Module[{$CellContext`q = $CellContext`squota[$CellContext`l, \
$CellContext`seats], $CellContext`app = $CellContext`epapport[$CellContext`l, \
$CellContext`seats]}, 
         Map[
         Part[#, 2]/$CellContext`q& , $CellContext`app]], $CellContext`means[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       Module[{$CellContext`votes = 
          Map[Part[#, 2]& , $CellContext`l], $CellContext`prs = N[
            Map[$CellContext`safeprs, 
             $CellContext`preseats[$CellContext`l, $CellContext`seats]]], \
$CellContext`pplus = N[
            Map[Sqrt, 
             Map[1 + #& , 
              $CellContext`preseats[$CellContext`l, $CellContext`seats]]]]}, 
         If[$CellContext`seats == 
          0, $CellContext`votes, $CellContext`votes/($CellContext`prs \
$CellContext`pplus)]], $CellContext`safeprs[
         Pattern[$CellContext`n, 
          Blank[]]] := If[$CellContext`n == 0, 1, 
         Sqrt[$CellContext`n]], $CellContext`actualrep[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       Module[{$CellContext`eap = $CellContext`epapport[$CellContext`list, \
$CellContext`seats]}, 
         Map[If[Part[
             Part[$CellContext`eap, #], 3] == 0, 0, 
           N[Part[
              Part[$CellContext`eap, #], 2]/Part[
             Part[$CellContext`eap, #], 3]]]& , 
          Part[
           Transpose[$CellContext`eap], 1]]], $CellContext`compratio[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       Module[{$CellContext`eap = $CellContext`epapport[$CellContext`list, \
$CellContext`seats], $CellContext`s = $CellContext`squota[$CellContext`list, \
$CellContext`seats]}, $CellContext`actualrep[$CellContext`list, \
$CellContext`seats]/$CellContext`s], $CellContext`bfformathead[
         Pattern[$CellContext`l, 
          Blank[]]] := 
       Map[Style[#, Bold, FontFamily -> "Arial"]& , $CellContext`l]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.5631115420503035`*^9, 3.56311160844402*^9, 3.563111689486162*^9, 
   3.563111923486573*^9, 3.563197675212126*^9, 3.5632120721482973`*^9, 
   3.563230197919671*^9, 3.563230425165671*^9, 3.563319393486208*^9, 
   3.563321079658883*^9, 3.5633211591878223`*^9, 3.5633212853608437`*^9, 
   3.5633214633571568`*^9, 3.5633216336470556`*^9, 3.56332166990152*^9, {
   3.563321743783249*^9, 3.5633217725653*^9}, 3.5633218111597676`*^9, 
   3.563322723904993*^9, 3.5634024684408903`*^9, 3.575578352934277*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"showcomparisons", "[", 
   RowBox[{"list_", ",", "seats_"}], "]"}], ":=", 
  RowBox[{"Column", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\"\<Total votes = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"eptotvotes", "[", 
         RowBox[{"list", ",", "seats"}], "]"}], "]"}], "<>", 
       "\"\<          \>\"", "<>", "\"\<Seats = \>\"", "<>", 
       RowBox[{"ToString", "[", "seats", "]"}], "<>", "\"\<          \>\"", 
       "<>", "\"\<Quota = \>\"", "<>", 
       RowBox[{"ToString", "[", 
        RowBox[{"squota", "[", 
         RowBox[{"list", ",", "seats"}], "]"}], "]"}]}], "//", "myf"}], ",", 
     RowBox[{"TableForm", "[", 
      RowBox[{
       RowBox[{"bfformatlist", "[", 
        RowBox[{"arrangecomparison", "[", 
         RowBox[{"list", ",", "seats"}], "]"}], "]"}], ",", 
       RowBox[{"TableHeadings", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"None", ",", 
          RowBox[{"bfformathead", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Name\>\"", ",", "\"\<Votes\>\"", ",", "\"\<SeatsAsgd\>\"", 
             ",", "\"\<SeatsIdeal\>\"", ",", "\"\<VotesPerSeat\>\"", ",", 
             "\"\<Deviation\>\""}], "}"}], "]"}]}], "}"}]}]}], "]"}]}], "}"}],
    "]"}]}]], "Input",
 CellChangeTimes->{
  3.5631073404723377`*^9, {3.5631074393609114`*^9, 3.563107445725723*^9}, {
   3.5631074974866133`*^9, 3.5631075167058473`*^9}, {3.5631075722575445`*^9, 
   3.563107597045988*^9}, 3.563108056361001*^9, {3.56311077757096*^9, 
   3.5631108060098104`*^9}, {3.563111362556388*^9, 3.5631113639447904`*^9}, {
   3.5632121270447936`*^9, 3.563212137138011*^9}, {3.5633217947641387`*^9, 
   3.563321801784151*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"showcomparisons", "[", 
  RowBox[{"lst1", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.563107610898813*^9, 3.5631076134104176`*^9}, 
   3.563108056392201*^9, {3.563108223094094*^9, 3.563108252827746*^9}}],

Cell[BoxData[
 TagBox[GridBox[{
    {
     StyleBox["\<\"Total votes = 28577          Seats = 0          Quota = no \
quota\"\>",
      StripOnInput->False,
      FontFamily->"Arial",
      FontWeight->Bold]},
    {
     TagBox[
      TagBox[GridBox[{
         {
          TagBox[
           StyleBox["\<\"Name\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"Votes\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"SeatsAsgd\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"SeatsIdeal\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"VotesPerSeat\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm], 
          TagBox[
           StyleBox["\<\"Deviation\"\>",
            StripOnInput->False,
            FontFamily->"Arial",
            FontWeight->Bold],
           HoldForm]},
         {
          StyleBox["1",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["5567",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["5567",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["2",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7775",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7775",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["3",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["4435",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["4435",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["4",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7800",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["7800",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]},
         {
          StyleBox["5",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3000",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["3000",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold], 
          StyleBox["0",
           StripOnInput->False,
           FontFamily->"Arial",
           FontWeight->Bold]}
        },
        GridBoxAlignment->{
         "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
        GridBoxDividers->{
         "Columns" -> {{False}}, "ColumnsIndexed" -> {}, 
          "Rows" -> {False, True, {False}, False}, "RowsIndexed" -> {}},
        GridBoxSpacings->{"Columns" -> {
            Offset[0.27999999999999997`], {
             Offset[2.0999999999999996`]}, 
            Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
            Offset[0.2], {
             Offset[0.4]}, 
            Offset[0.2]}, "RowsIndexed" -> {}}],
       {None, OutputFormsDump`HeadedColumns}],
      Function[BoxForm`e$, 
       TableForm[BoxForm`e$, TableHeadings -> {None, {
           Style["Name", Bold, FontFamily -> "Arial"], 
           Style["Votes", Bold, FontFamily -> "Arial"], 
           Style["SeatsAsgd", Bold, FontFamily -> "Arial"], 
           Style["SeatsIdeal", Bold, FontFamily -> "Arial"], 
           Style["VotesPerSeat", Bold, FontFamily -> "Arial"], 
           Style["Deviation", Bold, FontFamily -> "Arial"]}}]]]}
   },
   DefaultBaseStyle->"Column",
   GridBoxAlignment->{"Columns" -> {{Left}}},
   GridBoxItemSize->{"Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}],
  "Column"]], "Output",
 CellChangeTimes->{
  3.563107614252819*^9, 3.5631078278361998`*^9, 3.5631079989997005`*^9, {
   3.563108065861418*^9, 3.563108083161848*^9}, {3.5631082242172956`*^9, 
   3.5631082537949476`*^9}, 3.5631083293458805`*^9, 3.5631084910761447`*^9, 
   3.56310853937383*^9, 3.5631090231294785`*^9, 3.563109269750312*^9, 
   3.563110497378868*^9, 3.563110684282797*^9, 3.5631108106742187`*^9, 
   3.5631109935221395`*^9, 3.563111542393504*^9, 3.5631116897357626`*^9, 
   3.5631119245941753`*^9, 3.5631976760077267`*^9, 3.563212141381219*^9, 
   3.563230198356472*^9, 3.563230425430871*^9, 3.5633193938606086`*^9, 
   3.5633210800644836`*^9, 3.5633211678302374`*^9, 3.563321285891245*^9, 
   3.563321463715957*^9, 3.5633216340838566`*^9, 3.563321672085523*^9, {
   3.56332174415765*^9, 3.5633217729241004`*^9}, 3.563321811456168*^9, 
   3.563322724528994*^9, 3.563402468663903*^9, 3.5755783532618775`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["This is PartyComparison.cdf", "Subsection",
 CellChangeTimes->{{3.5632303972104216`*^9, 3.5632304081928415`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DynamicModule", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "list", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Dynamic", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"list", "=", 
        RowBox[{"epsetup", "[", 
         RowBox[{"{", 
          RowBox[{"n1", ",", "n2", ",", "n3", ",", "n4", ",", "n5"}], "}"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"showcomparisons", "[", 
        RowBox[{"list", ",", "seats"}], "]"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n1", ",", "8234"}], "}"}], ",", "0", ",", "10000", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n2", ",", "7001"}], "}"}], ",", "0", ",", "10000", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n3", ",", "5503"}], "}"}], ",", "0", ",", "10000", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n4", ",", "4356"}], "}"}], ",", "0", ",", "10000", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"n5", ",", "2390"}], "}"}], ",", "0", ",", "10000", ",", "1"}], 
    "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"seats", ",", "10"}], "}"}], ",", "0", ",", "100", ",", "1", 
     ",", 
     RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}], ",", 
   "\[IndentingNewLine]", 
   RowBox[{"Paneled", "\[Rule]", "False"}], ",", 
   RowBox[{"SaveDefinitions", "\[Rule]", "True"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.5631080302777553`*^9, 3.563108032461759*^9}, {
   3.5631081404139485`*^9, 3.5631081427227526`*^9}, 3.563111680375746*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`n1$$ = 8234, $CellContext`n2$$ = 
    7001, $CellContext`n3$$ = 5503, $CellContext`n4$$ = 
    4356, $CellContext`n5$$ = 2390, $CellContext`seats$$ = 10, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`n1$$], 8234}, 0, 10000, 1}, {{
       Hold[$CellContext`n2$$], 7001}, 0, 10000, 1}, {{
       Hold[$CellContext`n3$$], 5503}, 0, 10000, 1}, {{
       Hold[$CellContext`n4$$], 4356}, 0, 10000, 1}, {{
       Hold[$CellContext`n5$$], 2390}, 0, 10000, 1}, {{
       Hold[$CellContext`seats$$], 10}, 0, 100, 1}}, Typeset`size$$ = {
    597., {71., 78.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = False, $CellContext`n1$9581$$ = 
    0, $CellContext`n2$9582$$ = 0, $CellContext`n3$9583$$ = 
    0, $CellContext`n4$9584$$ = 0, $CellContext`n5$9585$$ = 
    0, $CellContext`seats$9586$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`n1$$ = 8234, $CellContext`n2$$ = 
        7001, $CellContext`n3$$ = 5503, $CellContext`n4$$ = 
        4356, $CellContext`n5$$ = 2390, $CellContext`seats$$ = 10}, 
      "ControllerVariables" :> {
        Hold[$CellContext`n1$$, $CellContext`n1$9581$$, 0], 
        Hold[$CellContext`n2$$, $CellContext`n2$9582$$, 0], 
        Hold[$CellContext`n3$$, $CellContext`n3$9583$$, 0], 
        Hold[$CellContext`n4$$, $CellContext`n4$9584$$, 0], 
        Hold[$CellContext`n5$$, $CellContext`n5$9585$$, 0], 
        Hold[$CellContext`seats$$, $CellContext`seats$9586$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> DynamicModule[{$CellContext`list}, 
        Dynamic[$CellContext`list = $CellContext`epsetup[{$CellContext`n1$$, \
$CellContext`n2$$, $CellContext`n3$$, $CellContext`n4$$, $CellContext`n5$$}]; \
$CellContext`showcomparisons[$CellContext`list, $CellContext`seats$$]]], 
      "Specifications" :> {{{$CellContext`n1$$, 8234}, 0, 10000, 
         1}, {{$CellContext`n2$$, 7001}, 0, 10000, 
         1}, {{$CellContext`n3$$, 5503}, 0, 10000, 
         1}, {{$CellContext`n4$$, 4356}, 0, 10000, 
         1}, {{$CellContext`n5$$, 2390}, 0, 10000, 
         1}, {{$CellContext`seats$$, 10}, 0, 100, 1, Appearance -> "Open"}}, 
      "Options" :> {Paneled -> False}, "DefaultOptions" :> {}],
     ImageSizeCache->{623., {226., 233.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    Initialization:>({$CellContext`epsetup[
         Pattern[$CellContext`l, 
          Blank[]]] := Transpose[{
          Range[
          5], $CellContext`l, $CellContext`zlist, $CellContext`l}], \
$CellContext`zlist := {0, 0, 0, 0, 0}, $CellContext`showcomparisons[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := Column[{
          $CellContext`myf[
           StringJoin["Total votes = ", 
            ToString[
             $CellContext`eptotvotes[$CellContext`list, $CellContext`seats]], 
            "          ", "Seats = ", 
            ToString[$CellContext`seats], "          ", "Quota = ", 
            ToString[
             $CellContext`squota[$CellContext`list, $CellContext`seats]]]], 
          TableForm[
           $CellContext`bfformatlist[
            $CellContext`arrangecomparison[$CellContext`list, \
$CellContext`seats]], TableHeadings -> {None, 
             $CellContext`bfformathead[{
              "Name", "Votes", "SeatsAsgd", "SeatsIdeal", "VotesPerSeat", 
               "Deviation"}]}]}], $CellContext`myf[
         Pattern[$CellContext`string, 
          Blank[]]] := 
       Style[$CellContext`string, Bold, FontFamily -> 
         "Arial"], $CellContext`eptotvotes[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := Apply[Plus, 
         Part[
          $CellContext`epapport[$CellContext`list, $CellContext`seats], All, 
          2]], $CellContext`epapport[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       NestWhile[$CellContext`update, $CellContext`l, 1, $CellContext`seats + 
         1], $CellContext`update[
         Pattern[$CellContext`l, 
          Blank[]]] := 
       Module[{$CellContext`li = ReplacePart[$CellContext`l, Part[
              $CellContext`pickit[$CellContext`l], 
              1] -> $CellContext`pickit[$CellContext`l]]}, 
         Return[$CellContext`li]], $CellContext`pickit[
         Pattern[$CellContext`l, 
          Blank[]]] := $CellContext`epchangeone[
         $CellContext`singleout[$CellContext`l]], $CellContext`epchangeone[
         Pattern[$CellContext`item, 
          Blank[]]] := {
         Part[$CellContext`item, 1], 
         Part[$CellContext`item, 2], Part[$CellContext`item, 3] + 1, 
         $CellContext`epwt[
          Part[$CellContext`item, 2], Part[$CellContext`item, 3] + 
          1]}, $CellContext`epwt[
         Pattern[$CellContext`p, 
          Blank[]], 
         Pattern[$CellContext`n, 
          Blank[]]] := If[$CellContext`n == 0, $CellContext`p, 
         N[$CellContext`p/
          Sqrt[$CellContext`n ($CellContext`n + 1)]]], $CellContext`singleout[
         Pattern[$CellContext`l, 
          Blank[]]] := Part[
         Select[$CellContext`l, Part[#, 4] == Max[
            Part[$CellContext`l, All, 4]]& , 1], 1], $CellContext`squota[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := If[$CellContext`seats == 0, "no quota", 
         N[$CellContext`totvotes[$CellContext`l]/$CellContext`seats]], \
$CellContext`totvotes[
         Pattern[$CellContext`l, 
          Blank[]]] := Apply[Plus, 
         Part[$CellContext`l, All, 2]], $CellContext`bfformatlist[
         Pattern[$CellContext`list, 
          Blank[]]] := 
       Map[Style[#, Bold, FontFamily -> "Arial"]& , $CellContext`list, {
         2}], $CellContext`arrangecomparison[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := Map[{
          Part[#, 1], 
          Part[#, 2], 
          Part[#, 3], 
          Part[#, 5], 
          Part[#, 8], 
          Part[#, 9]}& , 
         $CellContext`preshow[$CellContext`list, $CellContext`seats]], \
$CellContext`preshow[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       Module[{$CellContext`q = $CellContext`uquota[$CellContext`list, \
$CellContext`seats], $CellContext`p = \
$CellContext`preseats[$CellContext`list, $CellContext`seats], $CellContext`m = \
$CellContext`means[$CellContext`list, $CellContext`seats], $CellContext`t = \
$CellContext`eptotvotes[$CellContext`list, $CellContext`seats], \
$CellContext`a = $CellContext`actualrep[$CellContext`list, \
$CellContext`seats], $CellContext`c = \
$CellContext`compratio[$CellContext`list, $CellContext`seats]}, 
         Join[
          Map[{
            Part[#, 1], 
            Part[#, 2], 
            Part[#, 3], 
            Part[#, 4], 
            
            If[$CellContext`q == "no quota", "no quota", 
             Part[#, 2]/$CellContext`q]}& , 
           $CellContext`epapport[$CellContext`list, $CellContext`seats]], 
          
          Transpose[{$CellContext`p, $CellContext`m, $CellContext`a, \
$CellContext`c}], 2]], $CellContext`uquota[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := If[$CellContext`seats == 0, 1, 
         N[$CellContext`totvotes[$CellContext`l]/$CellContext`seats]], \
$CellContext`preseats[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := Map[Floor, 
         $CellContext`ideal[$CellContext`l, $CellContext`seats]], \
$CellContext`ideal[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       Module[{$CellContext`q = $CellContext`squota[$CellContext`l, \
$CellContext`seats], $CellContext`app = $CellContext`epapport[$CellContext`l, \
$CellContext`seats]}, 
         Map[
         Part[#, 2]/$CellContext`q& , $CellContext`app]], $CellContext`means[
         Pattern[$CellContext`l, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       Module[{$CellContext`votes = 
          Map[Part[#, 2]& , $CellContext`l], $CellContext`prs = N[
            Map[$CellContext`safeprs, 
             $CellContext`preseats[$CellContext`l, $CellContext`seats]]], \
$CellContext`pplus = N[
            Map[Sqrt, 
             Map[1 + #& , 
              $CellContext`preseats[$CellContext`l, $CellContext`seats]]]]}, 
         If[$CellContext`seats == 
          0, $CellContext`votes, $CellContext`votes/($CellContext`prs \
$CellContext`pplus)]], $CellContext`safeprs[
         Pattern[$CellContext`n, 
          Blank[]]] := If[$CellContext`n == 0, 1, 
         Sqrt[$CellContext`n]], $CellContext`actualrep[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       Module[{$CellContext`eap = $CellContext`epapport[$CellContext`list, \
$CellContext`seats]}, 
         Map[If[Part[
             Part[$CellContext`eap, #], 3] == 0, 0, 
           N[Part[
              Part[$CellContext`eap, #], 2]/Part[
             Part[$CellContext`eap, #], 3]]]& , 
          Part[
           Transpose[$CellContext`eap], 1]]], $CellContext`compratio[
         Pattern[$CellContext`list, 
          Blank[]], 
         Pattern[$CellContext`seats, 
          Blank[]]] := 
       Module[{$CellContext`eap = $CellContext`epapport[$CellContext`list, \
$CellContext`seats], $CellContext`s = $CellContext`squota[$CellContext`list, \
$CellContext`seats]}, $CellContext`actualrep[$CellContext`list, \
$CellContext`seats]/$CellContext`s], $CellContext`bfformathead[
         Pattern[$CellContext`l, 
          Blank[]]] := 
       Map[Style[#, Bold, FontFamily -> "Arial"]& , $CellContext`l]}; 
     Typeset`initDone$$ = True),
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.563111689954163*^9, 3.5631119247345753`*^9, 3.5631976760857267`*^9, 
   3.5632121491656322`*^9, 3.563230198465672*^9, 3.5632304255088716`*^9, 
   3.563319393954209*^9, 3.563321082154887*^9, 3.563321168142238*^9, 
   3.563321286125245*^9, 3.563321463809558*^9, 3.563321634193057*^9, 
   3.5633216840351443`*^9, {3.5633217442512503`*^9, 3.5633217730333004`*^9}, 
   3.5633218115653687`*^9, 3.5633227246693945`*^9, 3.5634024687569084`*^9, 
   3.5755783533398776`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{709, 669},
WindowMargins->{{261, Automatic}, {-46, Automatic}},
PrintingPageRange->{Automatic, Automatic},
FrontEndVersion->"9.0 for Microsoft Windows (32-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 155, 2, 101, "Title"],
Cell[CellGroupData[{
Cell[759, 28, 3209, 65, 129, "Input"],
Cell[3971, 95, 7893, 158, 330, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11901, 258, 148, 2, 49, "Subsection"],
Cell[12052, 262, 305, 6, 31, "Input"],
Cell[12360, 270, 227, 5, 31, "Input"],
Cell[12590, 277, 160, 4, 31, "Input"],
Cell[12753, 283, 228, 5, 31, "Input"],
Cell[12984, 290, 403, 10, 31, "Input"],
Cell[CellGroupData[{
Cell[13412, 304, 288, 9, 31, "Input"],
Cell[13703, 315, 2145, 32, 31, "Output"]
}, Open  ]],
Cell[15863, 350, 532, 15, 31, "Input"],
Cell[16398, 367, 196, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[16619, 374, 290, 9, 31, "Input"],
Cell[16912, 385, 1588, 24, 31, "Output"]
}, Open  ]],
Cell[18515, 412, 516, 8, 31, "Input"],
Cell[CellGroupData[{
Cell[19056, 424, 169, 2, 31, "Input"],
Cell[19228, 428, 3110, 50, 52, "Output"]
}, Open  ]],
Cell[22353, 481, 463, 11, 72, "Input"],
Cell[22819, 494, 169, 3, 31, "Input"],
Cell[CellGroupData[{
Cell[23013, 501, 98, 1, 31, "Input"],
Cell[23114, 504, 1312, 25, 52, "Output"]
}, Open  ]],
Cell[24441, 532, 220, 4, 31, "Input"],
Cell[CellGroupData[{
Cell[24686, 540, 97, 1, 31, "Input"],
Cell[24786, 543, 2461, 44, 52, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27296, 593, 111, 1, 49, "Subsection"],
Cell[27410, 596, 305, 6, 31, "Input"],
Cell[27718, 604, 628, 18, 31, "Input"],
Cell[CellGroupData[{
Cell[28371, 626, 133, 2, 31, "Input"],
Cell[28507, 630, 2843, 41, 31, "Output"]
}, Open  ]],
Cell[31365, 674, 593, 16, 31, "Input"],
Cell[CellGroupData[{
Cell[31983, 694, 349, 9, 31, "Input"],
Cell[32335, 705, 3761, 54, 31, "Output"]
}, Open  ]],
Cell[36111, 762, 1450, 32, 52, "Input"],
Cell[CellGroupData[{
Cell[37586, 798, 253, 5, 31, "Input"],
Cell[37842, 805, 2932, 43, 31, "Output"]
}, Open  ]],
Cell[40789, 851, 279, 6, 31, "Input"],
Cell[CellGroupData[{
Cell[41093, 861, 132, 2, 31, "Input"],
Cell[41228, 865, 2893, 42, 31, "Output"]
}, Open  ]],
Cell[44136, 910, 803, 19, 52, "Input"],
Cell[CellGroupData[{
Cell[44964, 933, 132, 2, 31, "Input"],
Cell[45099, 937, 3089, 50, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48225, 992, 127, 2, 31, "Input"],
Cell[48355, 996, 3078, 51, 52, "Output"]
}, Open  ]],
Cell[51448, 1050, 322, 8, 31, "Input"],
Cell[CellGroupData[{
Cell[51795, 1062, 129, 3, 31, "Input"],
Cell[51927, 1067, 3099, 50, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55063, 1122, 129, 3, 31, "Input"],
Cell[55195, 1127, 3148, 51, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58380, 1183, 330, 6, 31, "Input"],
Cell[58713, 1191, 4845, 77, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63595, 1273, 156, 3, 31, "Input"],
Cell[63754, 1278, 1398, 29, 52, "Output"]
}, Open  ]],
Cell[65167, 1310, 195, 6, 31, "Input"],
Cell[65365, 1318, 299, 9, 31, "Input"],
Cell[65667, 1329, 643, 13, 31, "Input"],
Cell[66313, 1344, 394, 11, 31, "Input"],
Cell[66710, 1357, 375, 11, 31, "Input"],
Cell[67088, 1370, 465, 10, 31, "Input"],
Cell[67556, 1382, 543, 15, 52, "Input"],
Cell[68102, 1399, 706, 21, 52, "Input"],
Cell[CellGroupData[{
Cell[68833, 1424, 303, 5, 31, "Input"],
Cell[69139, 1431, 1522, 23, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[70698, 1459, 255, 6, 31, "Input"],
Cell[70956, 1467, 414, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71407, 1478, 123, 2, 31, "Input"],
Cell[71533, 1482, 379, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71949, 1493, 513, 15, 31, "Input"],
Cell[72465, 1510, 441, 8, 31, "Output"]
}, Open  ]],
Cell[72921, 1521, 278, 7, 31, "Input"],
Cell[CellGroupData[{
Cell[73224, 1532, 158, 3, 31, "Input"],
Cell[73385, 1537, 1269, 19, 31, "Output"]
}, Open  ]],
Cell[74669, 1559, 281, 7, 31, "Input"],
Cell[74953, 1568, 1935, 46, 92, "Input"],
Cell[CellGroupData[{
Cell[76913, 1618, 152, 3, 31, "Input"],
Cell[77068, 1623, 707, 11, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77812, 1639, 334, 6, 31, "Input"],
Cell[78149, 1647, 1860, 29, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80046, 1681, 151, 3, 31, "Input"],
Cell[80200, 1686, 566, 10, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80803, 1701, 189, 4, 31, "Input"],
Cell[80995, 1707, 1880, 35, 101, "Output"]
}, Open  ]],
Cell[82890, 1745, 1730, 42, 92, "Input"],
Cell[CellGroupData[{
Cell[84645, 1791, 158, 3, 31, "Input"],
Cell[84806, 1796, 787, 14, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85630, 1815, 159, 3, 31, "Input"],
Cell[85792, 1820, 1156, 18, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86985, 1843, 242, 6, 31, "Input"],
Cell[87230, 1851, 542, 10, 31, "Output"]
}, Open  ]],
Cell[87787, 1864, 746, 19, 72, "Input"],
Cell[CellGroupData[{
Cell[88558, 1887, 159, 3, 31, "Input"],
Cell[88720, 1892, 593, 10, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89350, 1907, 132, 3, 31, "Input"],
Cell[89485, 1912, 452, 8, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[89986, 1926, 102, 1, 49, "Subsection"],
Cell[90091, 1929, 2102, 57, 172, "Input"],
Cell[CellGroupData[{
Cell[92218, 1990, 203, 4, 31, "Input"],
Cell[92424, 1996, 1851, 36, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94312, 2037, 151, 3, 31, "Input"],
Cell[94466, 2042, 1780, 35, 112, "Output"]
}, Open  ]],
Cell[96261, 2080, 660, 19, 52, "Input"],
Cell[CellGroupData[{
Cell[96946, 2103, 159, 3, 31, "Input"],
Cell[97108, 2108, 1083, 25, 52, "Output"]
}, Open  ]],
Cell[98206, 2136, 988, 25, 52, "Input"],
Cell[CellGroupData[{
Cell[99219, 2165, 218, 4, 31, "Input"],
Cell[99440, 2171, 1779, 36, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101256, 2212, 137, 3, 31, "Input"],
Cell[101396, 2217, 979, 25, 92, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102412, 2247, 132, 2, 31, "Input"],
Cell[102547, 2251, 1758, 33, 101, "Output"]
}, Open  ]],
Cell[104320, 2287, 340, 10, 52, "Input"],
Cell[104663, 2299, 264, 8, 31, "Input"],
Cell[104930, 2309, 212, 5, 31, "Input"],
Cell[105145, 2316, 1405, 34, 172, "Input"],
Cell[CellGroupData[{
Cell[106575, 2354, 160, 3, 31, "Input"],
Cell[106738, 2359, 5218, 153, 133, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[111993, 2517, 155, 3, 31, "Input"],
Cell[112151, 2522, 5214, 153, 133, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[117402, 2680, 157, 3, 31, "Input"],
Cell[117562, 2685, 4994, 152, 134, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[122605, 2843, 113, 1, 49, "Subsection"],
Cell[CellGroupData[{
Cell[122743, 2848, 2082, 53, 332, "Input"],
Cell[124828, 2903, 11121, 243, 372, "Output"]
}, Open  ]],
Cell[135964, 3149, 1730, 39, 232, "Input"],
Cell[CellGroupData[{
Cell[137719, 3192, 234, 4, 29, "Input"],
Cell[137956, 3198, 7184, 213, 135, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[145189, 3417, 119, 1, 47, "Subsection"],
Cell[CellGroupData[{
Cell[145333, 3422, 2037, 52, 306, "Input"],
Cell[147373, 3476, 11214, 246, 383, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
